<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Sabji Haat - Fresh Vegetables
    </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
      * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: &#39;Segoe UI&#39;, Arial, sans-serif;
        }
        
        body {
            background-color: white;
            max-width: 414px;
            margin: 0 auto;
            min-height: 100vh;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
            padding-bottom: 0;
        }
        
        header {
            background-color: white;
            padding: 10px 12px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        nav {
            display: flex;
            justify-content: center;
            gap: 30px;
        }
        
        nav a {
            color: black;
            text-decoration: none;
            font-weight: bold;
            font-size: 16px;
            padding: 5px 10px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 4px;
            backdrop-filter: blur(5px);
        }
        
        nav a:hover {
            background-color: rgba(245, 245, 245, 0.9);
        }
        
        .hero-section {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0;
        }
        
        .hero-image {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .hero-image img {
            width: 100%;
            height: auto;
            max-height: 200px;
            object-fit: contain;
            display: block;
        }
        
        .mission-image {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .mission-image img {
            width: 100%;
            height: auto;
            max-height: 250px;
            object-fit: contain;
            display: block;
        }
        
        .offer-banner {
            background: linear-gradient(135deg, #ff9800, #ff5722);
            color: white;
            padding: 10px 15px;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            width: 100%;
        }
        
        .icons-container {
            background-color: white;
            padding: 15px;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .icon {
            font-size: 24px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .whatsapp {
            color: #25D366;
        }
        
        .facebook {
            color: #1877F2;
        }
        
        .instagram {
            color: #E4405F;
        }
        
        .review {
            color: #FFA500;
        }
        
        .cart {
            color: #007BFF;
        }
        
        .icon:hover {
            transform: scale(1.1);
        }
        
        /* UPDATED SERVICES SECTION - SHOW 3 CARDS AT A TIME */
        .services-section {
            background: linear-gradient(135deg, #8d6e63, #5d4037);
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
            position: relative;
            overflow: hidden;
        }

        .services-title {
            text-align: center;
            color: white;
            font-size: 16px;
            margin-bottom: 5px;
            font-weight: bold;
            padding: 0 15px;
        }

        .services-subtitle {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            margin-bottom: 10px;
            padding: 0 15px;
        }

        .services-container-wrapper {
            position: relative;
            overflow: hidden;
            width: 100%;
            height: 130px; /* Adjusted height for 3 cards */
        }

        .services-container {
            display: flex;
            height: 100%;
            transition: transform 0.5s ease-in-out;
            width: 100%;
        }

        .service-card {
            flex: 0 0 calc(33.33% - 10px); /* Show 3 cards at a time */
            background: rgba(255, 255, 255, 0.85); /* More transparent background */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            margin: 0 5px; /* Reduced margins for 3 cards */
            display: flex;
            flex-direction: column;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .service-image {
            width: 100%;
            height: 80px; /* Adjusted image height */
            object-fit: cover;
            display: block;
        }

        .service-name {
            padding: 5px; /* Reduced padding */
            text-align: center;
            font-size: 11px; /* Smaller font */
            font-weight: bold;
            color: #5d4037;
            background: transparent; /* Transparent background */
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Navigation arrows */
        .services-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
            opacity: 0.8;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .services-nav:hover {
            background: white;
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
        }

        .services-nav.prev {
            left: 5px;
        }

        .services-nav.next {
            right: 5px;
        }

        .services-nav i {
            color: #5d4037;
            font-size: 14px;
        }

        /* Dots indicator */
        .services-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 10px;
            padding: 0 15px;
        }

        .services-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .services-dot.active {
            background: white;
            transform: scale(1.2);
        }

        .search-container {
            padding: 15px;
            background-color: white;
            border-bottom: 1px solid #f0f0f0;
            position: relative;
            cursor: pointer; /* Add cursor pointer to indicate clickable */
        }
        
        .search-bar {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            cursor: pointer; /* Make search bar clickable */
        }
        
        .search-bar:focus {
            border-color: #007BFF;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
        }
        
        .search-icon {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .search-icon:hover {
            color: #007BFF;
        }
       .category-section {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            border-bottom: 1px solid #f0f0f0;
            padding: 12px 8px 5px;
            border-radius: 12px;
            margin: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .category-images {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 0 5px;
        }
        
        .category-image {
            width: 55px;
            height: 55px;
            border-radius: 60px;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid #fdf900;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16);
        }
        
        .category-image:hover {
            transform: scale(1.08);
            border-color: #fb1302;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .category-image.active {
            border-color: #fb1302;
            box-shadow: 0 0 12px rgba(251, 19, 2, 0.7);
            transform: scale(1.05);
        }
        
        .category-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .category-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 4px;
            padding: 0 4px;
        }
        
        .category-btn {
             background: linear-gradient(135deg, #26734d, #2E7D32);
            color: white;
            border: none;
            padding: 7px 10px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 30px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }

        .category-btn:hover, .category-btn.active {
           background: linear-gradient(135deg, #fdf900, #ffeb3b);
            color: #fb1302;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .products-container {
            padding: 15px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            background: linear-gradient(135deg, #e8f5e9, #ffffff);
        }
        
        .product-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255,255,255,0.3);
            position: relative;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .product-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
        }
        
        .product-info {
            padding: 10px;
        }
        
        .product-name {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
            height: 40px;
            overflow: hidden;
        }
        
        .product-price {
            color: #e74c3c;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .product-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .quantity-selector {
            width: 100%;
            margin-bottom: 10px;
        }
        
        .quantity-options {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 5px;
        }
        
        .quantity-option {
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .quantity-option:hover, .quantity-option.active {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
        }
        
        .custom-quantity {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 5px;
        }
        
        .custom-quantity-input {
            width: 60px;
            padding: 4px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            text-align: center;
        }
        
        .custom-quantity-unit {
            font-size: 12px;
            color: #666;
        }
        
        .add-to-cart {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            transition: background 0.3s ease;
            width: 100%;
        }
        
        .add-to-cart:hover {
            background: linear-gradient(135deg, #c0392b, #a93226);
        }
        
        .add-to-cart:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        .add-to-cart:disabled:hover {
            background: #cccccc;
        }
        
        .out-of-stock {
            display: none !important;
        }

        
        .stock-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(231, 76, 60, 0.9);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
            z-index: 5;
        }
        
        .sticky-cart-btn {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .sticky-cart-btn:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, #c0392b, #a93226);
        }
        
        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #fdf900;
            color: #e74c3c;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .cart-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .cart-content {
            background: white;
            width: 90%;
            max-width: 400px;
            border-radius: 10px;
            padding: 20px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .cart-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .close-cart {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #777;
        }
        
        .cart-items {
            margin-bottom: 15px;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f5f5f5;
        }
        
        .cart-item-info {
            flex: 1;
        }
        
        .cart-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .cart-item-price {
            color: #e74c3c;
            font-size: 14px;
        }
        
        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .cart-total {
            font-weight: bold;
            font-size: 18px;
            text-align: right;
            margin: 15px 0;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        .checkout-btn {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s ease;
        }
        
        .checkout-btn:hover {
            background: linear-gradient(135deg, #45a049, #1b5e20);
        }
        
        .empty-cart {
            text-align: center;
            padding: 20px;
            color: #777;
        }
        
        footer {
            background-color: #f9f9f9;
            padding: 10px 15px;
            padding-top: 10px;
            text-align: center;
            font-size: 14px;
            color: #666;
            border-top: 1px solid #eee;
            margin-top: 0;
        }
        
        /* Reviews Section */
        .reviews-section {
            background: linear-gradient(135deg, #e8f5e9, #ffffff);
            padding: 30px 10px;
            text-align: center;
            overflow: hidden;
            margin-bottom: 0;
            padding-bottom: 10px;
            position: relative;
        }
/* Enhanced File Upload Styles */
.file-upload-container {
    margin-bottom: 15px;
}

.file-upload-label {
    display: block;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 15px 20px;
    border-radius: 10px;
    cursor: pointer;
    text-align: center;
    margin-bottom: 10px;
    transition: all 0.3s ease;
    font-weight: bold;
    font-size: 16px;
    border: none;
    width: 100%;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.file-upload-label:hover {
    background: linear-gradient(135deg, #764ba2, #667eea);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
}

.file-upload-label:active {
    transform: translateY(0);
}

.file-upload-input {
    display: none;
}

.image-preview {
    width: 100%;
    max-width: 200px;
    height: 150px;
    border: 2px dashed #ddd;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 15px auto;
    overflow: hidden;
    background: #f9f9f9;
    transition: all 0.3s ease;
}

.image-preview:hover {
    border-color: #667eea;
    background: #f0f0f0;
}

.image-preview img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: 8px;
}

/* Image Source Modal Animation */
.image-source-modal {
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Upload Progress */
.upload-progress {
    width: 100%;
    height: 4px;
    background: #f0f0f0;
    border-radius: 2px;
    margin: 10px 0;
    overflow: hidden;
}

.upload-progress-bar {
    height: 100%;
    background: linear-gradient(135deg, #4CAF50, #2E7D32);
    border-radius: 2px;
    transition: width 0.3s ease;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .file-upload-label {
        padding: 12px 15px;
        font-size: 14px;
    }
    
    .image-preview {
        max-width: 150px;
        height: 120px;
    }
}
        .review-title {
            color: #2e7d32;
            font-size: 24px;
            margin-bottom: 20px;
            font-weight: 600;
            letter-spacing: 1px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* UPDATED REVIEWS CONTAINER WITH SLIDING ANIMATION */
        .review-container-wrapper {
            position: relative;
            overflow: hidden;
            width: 100%;
            margin-bottom: 20px;
        }

        .review-container {
            display: flex;
            transition: transform 0.5s ease-in-out;
            width: 100%;
            gap: 15px;
            padding: 10px;
        }

        .review-card {
            flex: 0 0 280px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            padding: 15px;
            text-align: left;
            transition: all 0.4s ease;
            animation: fadeInUp 0.8s ease-out;
            animation-fill-mode: both;
            opacity: 0;
            transform: translateY(20px);
        }

        .review-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .review-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.4);
        }
        
        .review-card p {
            font-size: 14px;
            color: #444;
            line-height: 1.4;
        }
        
        .review-card h4 {
            margin-top: 1px;
            color: #2e7d32;
            font-weight: 600;
        }
        
        .stars {
            color: gold;
            font-size: 16px;
            margin-top: 5px;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Review navigation arrows */
        .review-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
            opacity: 0.8;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .review-nav:hover {
            background: white;
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
        }

        .review-nav.prev {
            left: 5px;
        }

        .review-nav.next {
            right: 5px;
        }

        .review-nav i {
            color: #5d4037;
            font-size: 14px;
        }

        /* Counter + Review Button */
        .review-stats {
            margin-top: 30px;
            margin-bottom: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            flex-wrap: wrap;
        }

        .counter {
            font-size: 26px;
            color: #2e7d32;
            font-weight: 700;
            text-align: center;
            animation: countUp 2s ease-out;
        }

        @keyframes countUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .counter p {
            font-size: 14px;
            color: #444;
            margin: 5px 0 0;
        }

        .review-btn {
            background: linear-gradient(135deg, #43a047, #1b5e20);
            color: #fff;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 14px;
            cursor: pointer;
            transition: 0.3s ease;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .review-btn:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #66bb6a, #2e7d32);
            animation: none;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            width: 90%;
            max-width: 400px;
            border-radius: 10px;
            padding: 20px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #777;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .location-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .location-btn {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f5f5f5;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .location-btn:hover {
            background: #e0e0e0;
        }
        
        .location-btn.active {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border-color: #4CAF50;
        }
        
        .business-hours-modal {
            text-align: center;
        }
        
        .business-hours-image {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .hours-details {
            background: #fff9e6;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #ffa500;
        }
        
        .hours-title {
            font-size: 18px;
            font-weight: bold;
            color: #e67e22;
            margin-bottom: 10px;
        }
        
        .hours-description {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .hours-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .hours-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .hours-primary {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .hours-secondary {
            background: #f0f0f0;
            color: #333;
        }
        
        .billing-details {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .billing-row {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
        }
        
        .billing-total {
            font-weight: bold;
            font-size: 18px;
            border-top: 1px solid #ddd;
            padding-top: 10px;
            margin-top: 10px;
        }
        
        .delivery-time {
            background: #e8f5e9;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            color: #2e7d32;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #2ecc71;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 4000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
        }
        
        /* Unit display for different product types */
        .unit-display {
            font-size: 12px;
            color: #666;
            margin-left: 5px;
        }
        
        /* About Us Page Styles */
        .about-page {
            display: none;
            padding: 20px;
            background-color: white;
            max-width: 414px;
            margin: 0 auto;
            min-height: 100vh;
        }
        
        .about-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .about-title {
            font-size: 24px;
            color: #2e7d32;
            margin-bottom: 10px;
        }
        
        .about-image {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .about-content {
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .about-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .feature-card {
            background: #f5f9f5;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #4CAF50;
        }
        
        .feature-icon {
            font-size: 24px;
            color: #4CAF50;
            margin-bottom: 10px;
        }
        
        .feature-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .back-to-home {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: background 0.3s ease;
        }
        
        .back-to-home:hover {
            background: linear-gradient(135deg, #45a049, #1b5e20);
        }
        
        /* Admin Panel Styles */
        .admin-panel {
            display: none;
            padding: 20px;
            background-color: white;
            max-width: 414px;
            margin: 0 auto;
            min-height: 100vh;
        }
        
        .admin-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .admin-title {
            font-size: 24px;
            color: #2e7d32;
            margin-bottom: 10px;
        }
        
        .admin-dashboard {
            display: block; /* Changed from none to block */
        }
        
        .admin-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .admin-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: #f5f5f5;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .admin-tab.active {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
        }
        
        .admin-tab-content {
            display: none;
        }
        
        .admin-tab-content.active {
            display: block;
        }
        
        .product-list {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        
        .admin-product-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
            background: #f9f9f9;
            margin-bottom: 8px;
            border-radius: 5px;
        }
        
        .admin-product-info {
            flex: 1;
        }
        
        .admin-product-name {
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .admin-product-details {
            font-size: 12px;
            color: #666;
        }
        
        .admin-product-actions {
            display: flex;
            gap: 8px;
        }
        
        .admin-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .edit-btn {
            background: #3498db;
            color: white;
        }
        
        .edit-btn:hover {
            background: #2980b9;
        }
        
        .delete-btn {
            background: #e74c3c;
            color: white;
        }
        
        .delete-btn:hover {
            background: #c0392b;
        }
        
        .save-btn {
            background: #2ecc71;
            color: white;
        }
        
        .save-btn:hover {
            background: #27ae60;
        }
        
        .cancel-btn {
            background: #95a5a6;
            color: white;
        }
        
        .cancel-btn:hover {
            background: #7f8c8d;
        }
        
        .add-product-form {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid #ddd;
        }
        
        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .form-row input, .form-row select {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .hidden {
            display: none;
        }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: #f5f9f5;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #4CAF50;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #2e7d32;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        .admin-search {
            margin-bottom: 15px;
        }
        
        .admin-search input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .category-filter {
            margin-bottom: 15px;
        }
        
        .category-filter select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .edit-product-form {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #ddd;
        }
        
        .edit-product-form h4 {
            margin-bottom: 10px;
            color: #2e7d32;
        }
        
        .image-upload-container {
            margin-bottom: 15px;
        }
        
        .image-preview {
            width: 100px;
            height: 100px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            overflow: hidden;
            background: #f9f9f9;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }

        .file-upload-label {
            display: block;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .file-upload-label:hover {
            background: linear-gradient(135deg, #2980b9, #1f618d);
            transform: translateY(-2px);
        }

        .file-upload-input {
            display: none;
        }
        
        .upload-btn {
            background: #3498db;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            display: inline-block;
            margin-top: 10px;
        }
        
        .upload-btn:hover {
            background: #2980b9;
        }
        
        .image-url-input {
            margin-top: 10px;
        }
        
        /* File upload styling */
        .file-upload-container {
            margin-bottom: 15px;
        }
        
        .admin-product-image {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 5px;
            margin-right: 10px;
        }
        
        /* Pincode Management */
        .pincode-management {
            margin-top: 20px;
        }
        
        .pincode-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 5px;
            margin-bottom: 8px;
        }
        
        .pincode-actions {
            display: flex;
            gap: 8px;
        }
        
        .pincode-charge {
            width: 80px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        /* Stock Management */
        .stock-management {
            margin-top: 20px;
        }
        
        .stock-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 5px;
            margin-bottom: 8px;
        }
        
        .stock-info {
            flex: 1;
        }
        
        .stock-name {
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .stock-details {
            font-size: 12px;
            color: #666;
        }
        
        .stock-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .stock-input {
            width: 80px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }
        
        .stock-status {
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .in-stock {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        .out-of-stock {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #c62828;
        }

        
        /* Packaging Charge Styles */
        .packaging-note {
            background: #fff9e6;
            border-left: 4px solid #ffa500;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-size: 14px;
            color: #333;
        }
        
        .packaging-highlight {
            color: #e74c3c;
            font-weight: bold;
        }
        
        /* Pickup Information */
        .pickup-info {
            background: #e8f5e9;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            color: #2e7d32;
        }
        
        /* Admin Login Modal */
        .admin-login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 5000;
            align-items: center;
            justify-content: center;
        }
        
        .admin-login-content {
            background: white;
            width: 90%;
            max-width: 350px;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .admin-login-title {
            text-align: center;
            margin-bottom: 20px;
            color: #2e7d32;
            font-size: 24px;
        }
        
        .admin-login-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .admin-login-input {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .admin-login-input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.3);
        }
        
        .admin-login-btn {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .admin-login-btn:hover {
            background: linear-gradient(135deg, #45a049, #1b5e20);
        }
        
        .admin-back-home {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s ease;
        }
        
        .admin-back-home:hover {
            background: #7f8c8d;
        }
        /* Add to CSS section */
.payment-instructions {
    background: linear-gradient(135deg, #fff3cd, #ffeaa7);
    border-left: 5px solid #f39c12;
    padding: 20px;
    margin: 20px 0;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.payment-steps {
    counter-reset: step-counter;
    margin-top: 15px;
}

.payment-step {
    display: flex;
    align-items: flex-start;
    margin-bottom: 15px;
    padding: 10px;
    background: white;
    border-radius: 8px;
    border-left: 4px solid #2ecc71;
}


.payment-highlight {
    color: #e74c3c;
    font-weight: bold;
    font-size: 16px;
    margin-top: 15px;
    text-align: center;
    padding: 10px;
    background: rgba(231, 76, 60, 0.1);
    border-radius: 8px;
    border: 2px dashed #e74c3c;
}

/* Performance improvements for product loading */
.product-card.fast-load {
    opacity: 0;
    animation: fadeIn 0.5s ease forwards;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.lazy-image {
    background: #f5f5f5;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
}

@keyframes loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}
    </style>
  </head>
  <body>
    <!-- Main App (Home Page) -->
    <div class="main-app">
      <header>
        <nav>
          <a href="#" class="nav-home" id="homeButton" onmousedown="startHomePress()" onmouseup="endHomePress()" ontouchstart="startHomePress()" ontouchend="endHomePress()">          HOME
</a>
          <a href="#" class="nav-about" onclick="showAboutPage()">          ABOUT US
</a>
        </nav>
      </header>
      <div class="hero-section">
        <div class="hero-image">
          <img src="Hero.jpg" alt="Fresh Vegetables" />
        </div>
        <div class="offer-banner" id="offerBanner">
          <!-- Dynamic content will be inserted here -->
        </div>
        
        <div class="icons-container">
          <i class="icon whatsapp fab fa-whatsapp" onclick="openWhatsApp()"></i>
          <i class="icon facebook fab fa-facebook" onclick="openFacebook()"></i>
          <i class="icon instagram fab fa-instagram" onclick="openInstagram()"></i>
          <i class="icon review fas fa-star" onclick="openGoogleReview()"></i>
          <i class="icon cart fas fa-shopping-cart" onclick="openCart()"></i>
        </div>
      </div>
      <!-- UPDATED SERVICES SECTION - SHOW 3 CARDS AT A TIME -->
      <div class="services-section">
        <h3 class="services-title">
          Our Special Services
        </h3>
        <p class="services-subtitle">
          Click any service to contact owner directly via WhatsApp
        </p>
        <div class="services-container-wrapper">
          <button class="services-nav prev" onclick="slideServices(&#39;prev&#39;)">
            <i class="fas fa-chevron-left"></i>
          </button>
          <div class="services-container" id="servicesContainer">
            <div class="service-card" onclick="openServiceWhatsApp(&#39;Restaurant Orders&#39;)">
              <img src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=500&amp;q=60" alt="Restaurant Orders" class="service-image" />
              <div class="service-name">
                Restaurant Orders
              </div>
            </div>
            <div class="service-card" onclick="openServiceWhatsApp(&#39;Catering Orders&#39;)">
              <img src="https://images.unsplash.com/photo-1555244162-803834f70033?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=500&amp;q=60" alt="Catering Orders" class="service-image" />
              <div class="service-name">
                Catering Orders
              </div>
            </div>
            <div class="service-card" onclick="openServiceWhatsApp(&#39;Special Occasions&#39;)">
              <img src="https://cdn.pixabay.com/photo/2023/11/03/16/19/celebration-8363367_1280.jpg" alt="Special Occasions" class="service-image" />
              <div class="service-name">
                Special Occasions
              </div>
            </div>
            <div class="service-card" onclick="openServiceWhatsApp(&#39;Bulk Orders&#39;)">
              <img src="https://plus.unsplash.com/premium_photo-1686529896385-8a8d581d0225?ixlib=rb-4.1.0&amp;ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTd8fGJ1bGslMjBvcmRlciUyMHZlZ3xlbnwwfHwwfHx8MA%3D%3D&amp;auto=format&amp;fit=crop&amp;q=60&amp;w=600" alt="Bulk Orders" class="service-image" />
              <div class="service-name">
                Bulk Orders
              </div>
            </div>
            <div class="service-card" onclick="openServiceWhatsApp(&#39;Wholesale Price&#39;)">
              <img src="wholesaler.png" alt="Wholesale Price" class="service-image" />
              <div class="service-name">
                Wholesale Price
              </div>
            </div>
          </div>
          <button class="services-nav next" onclick="slideServices(&#39;next&#39;)">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
        <div class="services-dots" id="servicesDots">
          <!-- Dots will be generated by JavaScript -->
        </div>
      </div>
      <div class="search-container">
        <input type="text" class="search-bar" placeholder="Search products..." id="searchInput" />
        <i class="search-icon fas fa-search" id="searchIcon"></i>
      </div>
      <div class="category-section">
        <div class="category-images">
          <div class="category-image active" data-category="indian" onclick="loadCategory(&#39;indian&#39;)">
            <img src="categoryimageindian.jpg" alt="Indian Vegetables" />
          </div>
          <div class="category-image" data-category="exotic" onclick="loadCategory(&#39;exotic&#39;)">
            <img src="exoticcategoryimage.jpg" alt="Exotic Vegetables" />
          </div>
          <div class="category-image" data-category="leafy" onclick="loadCategory(&#39;leafy&#39;)">
            <img src="https://images.unsplash.com/photo-1576045057995-568f588f82fb?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=500&amp;q=60" alt="Leafy Vegetables" />
          </div>
          <div class="category-image" data-category="others" onclick="loadCategory(&#39;others&#39;)">
            <img src="paneerimage.jpg" alt="Other Products" />
          </div>
          <div class="category-image" data-category="puja" onclick="loadCategory(&#39;puja&#39;)">
            <img src="https://img.freepik.com/premium-photo/copper-kalash-with-coconut-mango-leaf-with-floral-decoration-diya-haldi-kumkum-sweet-pedha-essential-hindu-puja-front-view-closeup-red-surface_466689-47208.jpg?semt=ais_hybrid&amp;w=740&amp;q=80" alt="Puja Needs" />
          </div>
        </div>
        <div class="category-buttons">
          <button class="category-btn active" data-category="indian" onclick="loadCategory(&#39;indian&#39;)">
            Indian
          </button>
          <button class="category-btn" data-category="exotic" onclick="loadCategory(&#39;exotic&#39;)">
            Exotic
          </button>
          <button class="category-btn" data-category="leafy" onclick="loadCategory(&#39;leafy&#39;)">
            Leafy
          </button>
          <button class="category-btn" data-category="others" onclick="loadCategory(&#39;others&#39;)">
            Others
          </button>
          <button class="category-btn" data-category="puja" onclick="loadCategory(&#39;puja&#39;)">
            Puja Needs
          </button>
        </div>
      </div>
      <div class="products-container" id="productsContainer">
        <!-- Products will be loaded here dynamically -->
      </div>
      <div class="mission-image">
        <img src="mission.jpg" alt="Our Mission" />
      </div>
      <button class="sticky-cart-btn" onclick="openCart()">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count" id="cartCount">        0
</span>
      </button>
      <!-- CUSTOMER REVIEWS SECTION WITH SLIDING ANIMATION -->
      <section class="reviews-section">
        <h2 class="review-title">
           What Our Customers Say
        </h2>
        <div class="review-container-wrapper">
          <button class="review-nav prev" onclick="slideReviews(&#39;prev&#39;)">
            <i class="fas fa-chevron-left"></i>
          </button>
          <div class="review-container" id="reviewContainer">
            <!-- Review Cards -->
            <div class="review-card">
              <p>
                &#34;Best place to buy fresh vegetables  quality is always top-notch!&#34;
              </p>
              <h4>
                 Arjun
              </h4>
              <div class="stars">
                
              </div>
            </div>
            <div class="review-card">
              <p>
                &#34;Timely pickup every morning! The bulk orders are handled very professionally.&#34;
              </p>
              <h4>
                 Suman
              </h4>
              <div class="stars">
                
              </div>
            </div>
            <div class="review-card">
              <p>
                &#34;Fresh vegetables every morning! SabjiHaat has made my home cooking so much easier.&#34;
              </p>
              <h4>
                 Anjali Das
              </h4>
              <div class="stars">
                
              </div>
            </div>
            <div class="review-card">
              <p>
                &#34;Amazing freshness and great pricing  SabjiHaat has made my daily shopping easy!&#34;
              </p>
              <h4>
                 Neha Sharma
              </h4>
              <div class="stars">
                
              </div>
            </div>
            <div class="review-card">
              <p>
                &#34;Reliable and honest service. Vegetables are always clean and well packed.&#34;
              </p>
              <h4>
                 Rajesh Kumar
              </h4>
              <div class="stars">
                
              </div>
            </div>
            <div class="review-card">
              <p>
                &#34;As a restaurant owner, I save both time and money. Highly recommend SabjiHaat!&#34;
              </p>
              <h4>
                 Priya Singh
              </h4>
              <div class="stars">
                
              </div>
            </div>
          </div>
          <button class="review-nav next" onclick="slideReviews(&#39;next&#39;)">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
        <div class="review-stats">
          <div class="counter">
            <span id="happyCount">            0
</span>
            +
            <p>
              Happy Customers
            </p>
          </div>
          <button class="review-btn" onclick="openGoogleReview()">
             Leave a Google Review
          </button>
        </div>
        <!-- ADDED PACKAGING NOTE IN REVIEWS SECTION -->
        <div class="packaging-note">
          <strong>           Note:
</strong>
          All orders include a
          <span class="packaging-highlight">          packaging charge
</span>
          for safe and hygienic packaging.
        </div>
      </section>
      <!-- Add this after the reviews section and before the footer -->
      <
        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin-top: 15px;">
          <h4 style="color: #2e7d32; margin-bottom: 10px;">
            <i class="fas fa-info-circle"></i>
            Important Notes:
          </h4>
          <ul style="margin-left: 20px; color: #444;">
            <li>
              Orders accepted from 10 AM to 10 PM only
            </li>
            <li>
              Next-day pickup available for all orders
            </li>
            <li>
              Bring your order ID and payment screenshot for pickup
            </li>
            <li>
              Packaging charge applies to all orders for safe handling
            </li>
            <li>
              For bulk orders (&gt; 5000), contact us directly for special rates
            </li>
          </ul>
        </div>
      </section>
      <footer>
        <p>
           2025 SabjiHaat. All rights reserved.
        </p>
        <p>
          Jadavpur Sandhya Bazar Rd, West Bengal Kolkata-700075
        </p>
      </footer>
    </div>
    <!-- About Us Page -->
    <div class="about-page" id="aboutPage">
      <div class="about-header">
        <h1 class="about-title">
          About Sabji Haat
        </h1>
        <img src="https://images.unsplash.com/photo-1542838132-92c53300491e?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="About Sabji Haat" class="about-image" />
      </div>
      <div class="about-content">
        <p>
          Welcome to Sabji Haat, your trusted partner for fresh, high-quality vegetables available for pickup at our store. Established in 2020, we&#39;ve been serving the Kolkata community with the freshest produce sourced directly from local farmers.
        </p>
        <p>
          Our mission is simple: to provide fresh, healthy, and affordable vegetables while supporting local agriculture and reducing food waste. We believe that everyone deserves access to quality produce, and we&#39;re committed to making that a reality.
        </p>
        <h3>
          Why Choose Sabji Haat?
        </h3>
        <div class="about-features">
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-leaf"></i>
            </div>
            <div class="feature-title">
              Farm Fresh
            </div>
            <p>
              Direct from farms to your kitchen
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-store"></i>
            </div>
            <div class="feature-title">
              Easy Pickup
            </div>
            <p>
              Convenient store pickup available
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-rupee-sign"></i>
            </div>
            <div class="feature-title">
              Best Prices
            </div>
            <p>
              Competitive pricing guaranteed
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-award"></i>
            </div>
            <div class="feature-title">
              Quality Assured
            </div>
            <p>
              Rigorous quality checks
            </p>
          </div>
        </div>
        <h3>
          Our Story
        </h3>
        <p>
          Sabji Haat began as a small family business with a simple vision: to bridge the gap between local farmers and urban consumers. What started as a single vegetable cart has now grown into a trusted platform serving hundreds of customers daily.
        </p>
        <div class="payment-highlight">
           Your order will be confirmed only after 50% advance payment
        </div>
        <!-- ADDED PACKAGING NOTE IN ABOUT PAGE -->
        <div class="packaging-note" style="margin-top: 20px;">
          <strong>           Packaging:
</strong>
          All orders include a packaging charge for safe and hygienic handling of your vegetables.
        </div>
      </div>
      <button class="back-to-home" onclick="showHomePage()">
        Back to Home
      </button>
    </div>
    <!-- Admin Login Modal -->
    <div class="admin-login-modal" id="adminLoginModal">
      <div class="admin-login-content">
        <h2 class="admin-login-title">
          Admin Login
        </h2>
        <form class="admin-login-form" id="adminLoginForm">
          <input type="text" class="admin-login-input" id="adminUsername" placeholder="Username" required="" />
          <input type="password" class="admin-login-input" id="adminPassword" placeholder="Password" required="" />
          <button type="submit" class="admin-login-btn">
            Login
          </button>
        </form>
        <button class="admin-back-home" onclick="closeAdminLogin()">
          Back to Home
        </button>
      </div>
    </div>
    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
      <div class="admin-header">
        <h1 class="admin-title">
          Admin Panel
        </h1>
        <button class="admin-btn logout-btn" onclick="adminLogout()" style="background: #e74c3c; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin-left: auto;">
          Logout
        </button>
      </div>
      <div class="admin-dashboard" id="adminDashboard">
        <div class="admin-tabs">
          <button class="admin-tab active" onclick="switchAdminTab(&#39;products&#39;)">
            Products
          </button>
          <button class="admin-tab" onclick="switchAdminTab(&#39;settings&#39;)">
            Settings
          </button>
          <button class="admin-tab" onclick="switchAdminTab(&#39;stock&#39;)">
            Stock Management
          </button>
        </div>
        <div class="admin-tab-content active" id="productsTab">
          <div class="admin-search">
            <input type="text" id="adminProductSearch" placeholder="Search products..." oninput="filterAdminProducts()" />
          </div>
          <div class="category-filter">
            <select id="adminCategoryFilter" onchange="filterAdminProducts()">
              <option value="all">
                All Categories
              </option>
              <option value="indian">
                Indian
              </option>
              <option value="exotic">
                Exotic
              </option>
              <option value="leafy">
                Leafy
              </option>
              <option value="others">
                Others
              </option>
              <option value="puja">
                Puja Needs
              </option>
            </select>
          </div>
          <div class="product-list" id="adminProductList">
            <!-- Admin product list will be loaded here -->
          </div>
          <button class="admin-btn save-btn" onclick="showAddProductForm()">
            Add New Product
          </button>
          <div class="add-product-form hidden" id="addProductForm">
            <h4>
              Add New Product
            </h4>
            <div class="form-row">
              <input type="text" id="newProductName" placeholder="Product Name" />
              <input type="number" id="newProductPrice" placeholder="Price" />
            </div>
            <div class="form-row">
              <select id="newProductCategory">
                <option value="indian">
                  Indian
                </option>
                <option value="exotic">
                  Exotic
                </option>
                <option value="leafy">
                  Leafy
                </option>
                <option value="others">
                  Others
                </option>
                <option value="puja">
                  Puja Needs
                </option>
              </select>
              <select id="newProductUnit">
                <option value="kg">
                  kg
                </option>
                <option value="piece">
                  piece
                </option>
                <option value="bunch">
                  bunch
                </option>
                <option value="packet">
                  packet
                </option>
                <option value="tin">
                  tin
                </option>
                <option value="bottle">
                  bottle
                </option>
              </select>
            </div>
            <div class="form-row">
              <input type="number" id="newProductStock" placeholder="Stock Quantity" value="10" />
            </div>
            <!-- Image upload section -->
            <div class="file-upload-container">
              <label for="newProductImageUpload" class="file-upload-label">
                <i class="fas fa-camera"></i>
                Choose from Gallery
              </label>
              <input type="file" id="newProductImageUpload" class="file-upload-input" accept="image/*" capture="environment" />
              <div style="font-size: 12px; color: #666; margin-top: 5px;">
                Supports: JPEG, PNG, WebP (Max 5MB)
              </div>
              <div class="image-preview" id="newProductImagePreview">
              </div>
            </div>
            <div class="form-row">
              <input type="text" id="newProductImage" placeholder="Or enter image URL" />
            </div>
            <div class="form-row">
              <button class="admin-btn save-btn" onclick="addNewProduct()">
                Save Product
              </button>
              <button class="admin-btn cancel-btn" onclick="hideAddProductForm()">
                Cancel
              </button>
            </div>
          </div>
          <!-- Edit Product Form -->
          <div class="edit-product-form hidden" id="editProductForm">
            <h4>
              Edit Product
            </h4>
            <div class="form-row">
              <input type="text" id="editProductName" placeholder="Product Name" />
              <input type="number" id="editProductPrice" placeholder="Price" />
            </div>
            <div class="form-row">
              <select id="editProductCategory">
                <option value="indian">
                  Indian
                </option>
                <option value="exotic">
                  Exotic
                </option>
                <option value="leafy">
                  Leafy
                </option>
                <option value="others">
                  Others
                </option>
                <option value="puja">
                  Puja Needs
                </option>
              </select>
              <select id="editProductUnit">
                <option value="kg">
                  kg
                </option>
                <option value="piece">
                  piece
                </option>
                <option value="bunch">
                  bunch
                </option>
                <option value="packet">
                  packet
                </option>
                <option value="tin">
                  tin
                </option>
                <option value="bottle">
                  bottle
                </option>
              </select>
            </div>
            <div class="form-row">
              <input type="number" id="editProductStock" placeholder="Stock Quantity" />
            </div>
            <!-- For edit form -->
            <div class="file-upload-container">
              <label for="editProductImageUpload" class="file-upload-label">
                <i class="fas fa-upload"></i>
                Upload New Product Image
              </label>
              <input type="file" id="editProductImageUpload" class="file-upload-input" accept="image/*" capture="environment" />
              <div style="font-size: 12px; color: #666; margin-top: 5px;">
                Supports: JPEG, PNG, WebP (Max 5MB)
              </div>
              <div class="image-preview" id="editProductImagePreview">
              </div>
            </div>
            <div class="form-row">
              <input type="text" id="editProductImage" placeholder="Or enter image URL" />
            </div>
            <div class="form-row">
              <button class="admin-btn save-btn" onclick="updateProduct()">
                Update Product
              </button>
              <button class="admin-btn cancel-btn" onclick="hideEditProductForm()">
                Cancel
              </button>
            </div>
          </div>
        </div>
        <div class="admin-tab-content" id="settingsTab">
          <div class="admin-stats">
            <div class="stat-card">
              <div class="stat-value" id="totalProducts">
                0
              </div>
              <div class="stat-label">
                Total Products
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="totalOrders">
                0
              </div>
              <div class="stat-label">
                Total Orders
              </div>
            </div>
          </div>
          <h4>
            Store Settings
          </h4>
          <div class="form-group">
            <label>
              Packaging Charge ()
            </label>
            <input type="number" id="packagingCharge" value="10" />
          </div>
          <button class="admin-btn save-btn" onclick="saveSettings()">
            Save Settings
          </button>
        </div>
        <div class="admin-tab-content" id="stockTab">
          <h4>
            Stock Management
          </h4>
          <div class="admin-search">
            <input type="text" id="stockSearch" placeholder="Search products..." oninput="filterStockProducts()" />
          </div>
          <div class="category-filter">
            <select id="stockCategoryFilter" onchange="filterStockProducts()">
              <option value="all">
                All Categories
              </option>
              <option value="indian">
                Indian
              </option>
              <option value="exotic">
                Exotic
              </option>
              <option value="leafy">
                Leafy
              </option>
              <option value="others">
                Others
              </option>
              <option value="puja">
                Puja Needs
              </option>
            </select>
          </div>
          <div class="stock-management">
            <div id="stockList">
              <!-- Stock items will be loaded here -->
            </div>
          </div>
        </div>
      </div>
      <button class="back-to-home" onclick="showHomePage()">
        Back to Home
      </button>
    </div>
    <!-- Cart Modal -->
    <div class="cart-modal" id="cartModal">
      <div class="cart-content">
        <div class="cart-header">
          <h2 class="cart-title">
            Your Cart
          </h2>
          <button class="close-cart" onclick="closeCart()">
            
          </button>
        </div>
        <div class="cart-items" id="cartItems">
          <!-- Cart items will be loaded here -->
        </div>
        <div class="cart-total" id="cartTotal">
          Total: 0
        </div>
        <div class="payment-highlight">
           Your order will be confirmed only after 50% advance payment
        </div>
        <!-- PICKUP INFORMATION -->
        <div class="pickup-info">
           Order will be ready for pickup at our store
        </div>
        <!-- ADDED PACKAGING NOTE IN CART -->
        <div class="packaging-note">
          <strong>           Packaging Charge:
</strong>
          All orders include a packaging charge for safe and hygienic handling.
        </div>
        <button class="checkout-btn" id="checkoutBtn" onclick="checkBusinessHours()">
          Confirm Order via WhatsApp
        </button>
      </div>
    </div>
    <!-- Checkout Modal -->
    <div class="modal" id="checkoutModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">
            Order Confirmation
          </h2>
          <button class="close-modal" onclick="closeCheckoutModal()">
            
          </button>
        </div>
        <form id="checkoutForm">
          <div class="form-group">
            <label for="customerName">
              Full Name *
            </label>
            <input type="text" id="customerName" required="" />
          </div>
          <div class="form-group">
            <label for="customerPhone">
              Phone Number *
            </label>
            <input type="tel" id="customerPhone" required="" />
          </div>
          <div class="payment-highlight">
             Your order will be confirmed only after 50% advance payment
          </div>
          <div class="pickup-info">
            
            <strong>            Pickup Information:
</strong>
            <br />
            Your order will be ready for pickup at our store:
            <br />
            <strong>            Sabji Haat, Jadavpur Sandhya Bazar Rd, Kolkata-700075
</strong>
          </div>
          <div class="billing-details" id="billingSummary">
            <!-- Billing summary will be loaded here -->
          </div>
          <!-- ADDED PACKAGING NOTE IN CHECKOUT -->
          <div class="packaging-note">
            <strong>             Note:
</strong>
            All orders include a packaging charge for safe and hygienic handling of your vegetables.
          </div>
          <button type="button" class="checkout-btn" onclick="validateAndCheckout()">
            Confirm Order via WhatsApp
          </button>
        </form>
      </div>
    </div>
    <!-- Business Hours Modal -->
    <div class="modal" id="businessHoursModal">
      <div class="modal-content business-hours-modal">
        <div class="modal-header">
          <h2 class="modal-title">
            Store Closed
          </h2>
          <button class="close-modal" onclick="closeBusinessHoursModal()">
            
          </button>
        </div>
        <img src="https://images.unsplash.com/photo-1592924357228-91a4daadcfea?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=800&amp;q=80" class="business-hours-image" />
        <div class="hours-details">
          <div class="hours-title">
            Our Store Hours
          </div>
          <div class="hours-description">
            We&#39;re currently closed. Please place your orders between 10:00 AM and 10:00 PM for next day pickup.
          </div>
          <div class="hours-actions">
            <button class="hours-btn hours-primary" onclick="closeBusinessHoursModal()">
              OK
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Notification -->
    <div class="notification" id="notification">
    </div>
    <script>
      // Business information - loaded from API
let BUSINESS_INFO = {
    name: &#34;Sabji Haat&#34;,
    phone: &#34;+919051410591&#34;,
    address: &#34;Jadavpur Sandhya Bazar Rd, West Bengal Kolkata-700075&#34;,
    instagram: &#34;https://www.instagram.com/invites/contact/?utm_source=ig_contact_invite&amp;utm_medium=copy_link&amp;utm_content=seyxfz6&#34;,
    facebook: &#34;https://www.facebook.com/sabjihaat?mibextid=ZbWKwL&#34;,
    googleReview: &#34;https://maps.app.goo.gl/1DNV5UUPp2MXR81fA&#34;,
    packagingCharge: 10
};

// Cloudinary Configuration
const CLOUDINARY_UPLOAD_PRESET = &#39;sabji_haat&#39;;
const CLOUDINARY_CLOUD_NAME = &#39;dmt4fr2rp&#39;;

// Product data - loaded from API, organized by category
let PRODUCTS = {
    indian: [],
    exotic: [],
    leafy: [],
    others: [],
    puja: []
};

// Current loading state
let isLoading = false;
let currentCategory = &#39;indian&#39;;
let categoryLoadQueue = [];

// Quantity options based on product type
const getQuantityOptions = (unit) =&gt; {
    switch(unit) {
        case &#39;piece&#39;:
        case &#39;bunch&#39;:
        case &#39;packet&#39;:
        case &#39;tin&#39;:
        case &#39;bottle&#39;:
            return [
                { label: &#34;1&#34;, value: 1 },
                { label: &#34;2&#34;, value: 2 },
                { label: &#34;3&#34;, value: 3 },
                { label: &#34;4&#34;, value: 4 }
            ];
        case &#39;kg&#39;:
            return [
                { label: &#34;250g&#34;, value: 0.25 },
                { label: &#34;500g&#34;, value: 0.5 },
                { label: &#34;1kg&#34;, value: 1 },
                { label: &#34;2kg&#34;, value: 2 }
            ];
        default:
            return [
                { label: &#34;250g&#34;, value: 0.25 },
                { label: &#34;500g&#34;, value: 0.5 },
                { label: &#34;1kg&#34;, value: 1 },
                { label: &#34;2kg&#34;, value: 2 }
            ];
    }
};

// Cart state
let cart = [];
let selectedQuantities = {};
let productsVisible = true;
let editingProductId = null;
let homeClickCount = 0;
let homePressTimer = null;
let reviewsScrollInterval = null;

// Services animation variables - UPDATED FOR 3 CARDS
let servicesCurrentSlide = 0;
let servicesTotalSlides = 1;
let servicesAutoSlideInterval;

// Reviews animation variables
let reviewsCurrentSlide = 0;
let reviewsTotalSlides = 2;
let reviewsAutoSlideInterval;

// DOM elements
const productsContainer = document.getElementById(&#39;productsContainer&#39;);
const cartModal = document.getElementById(&#39;cartModal&#39;);
const cartItems = document.getElementById(&#39;cartItems&#39;);
const cartTotal = document.getElementById(&#39;cartTotal&#39;);
const cartCount = document.getElementById(&#39;cartCount&#39;);
const searchInput = document.getElementById(&#39;searchInput&#39;);
const searchIcon = document.getElementById(&#39;searchIcon&#39;);
const categoryButtons = document.querySelectorAll(&#39;.category-btn&#39;);
const categoryImages = document.querySelectorAll(&#39;.category-image&#39;);
const checkoutModal = document.getElementById(&#39;checkoutModal&#39;);
const checkoutForm = document.getElementById(&#39;checkoutForm&#39;);
const billingSummary = document.getElementById(&#39;billingSummary&#39;);
const businessHoursModal = document.getElementById(&#39;businessHoursModal&#39;);
const notification = document.getElementById(&#39;notification&#39;);
const adminLoginModal = document.getElementById(&#39;adminLoginModal&#39;);
const adminPanel = document.getElementById(&#39;adminPanel&#39;);
const adminDashboard = document.getElementById(&#39;adminDashboard&#39;);
const adminLoginForm = document.getElementById(&#39;adminLoginForm&#39;);
const offerBanner = document.getElementById(&#39;offerBanner&#39;);

// Admin credentials and token
const ADMIN_CREDENTIALS = {
    username: &#34;admin&#34;,
    password: &#34;sabjihaat2025&#34;
};
let adminToken = null;

// ==================== CLOUDINARY FUNCTIONS ====================

// Enhanced Cloudinary upload function
async function uploadToCloudinary(file) {
    try {
        // Convert file to base64
        const base64Data = await new Promise((resolve, reject) =&gt; {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () =&gt; {
                const base64 = reader.result.split(&#39;,&#39;)[1];
                resolve(base64);
            };
            reader.onerror = error =&gt; reject(error);
        });
        
        const response = await fetch(`${API_BASE_URL}/upload-cloudinary`, {
            method: &#39;POST&#39;,
            headers: {
                &#39;Content-Type&#39;: &#39;application/json&#39;,
                &#39;Authorization&#39;: adminToken ? `Bearer ${adminToken}` : &#39;&#39;
            },
            body: JSON.stringify({ image: base64Data })
        });
        
        if (!response.ok) {
            const errorData = await response.text();
            throw new Error(`Upload failed: ${response.status} ${errorData}`);
        }
        
        const data = await response.json();
        console.log(&#39; Cloudinary upload successful:&#39;, data.imageUrl);
        return data.imageUrl;
    } catch (error) {
        console.error(&#39; Cloudinary upload error:&#39;, error);
        throw new Error(&#39;Image upload failed: &#39; + error.message);
    }
}

// Setup image upload with Cloudinary
function setupImageUpload(inputElement, previewElement, urlInputElement) {
    if (!inputElement) return;
    
    inputElement.addEventListener(&#39;change&#39;, async function(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        // Validate file type
        const validTypes = [&#39;image/jpeg&#39;, &#39;image/jpg&#39;, &#39;image/png&#39;, &#39;image/gif&#39;, &#39;image/webp&#39;];
        if (!validTypes.includes(file.type)) {
            showNotification(&#39;Please select a valid image file (JPEG, PNG, GIF, WebP)&#39;, &#39;error&#39;);
            return;
        }
        
        // Validate file size (5MB)
        if (file.size &gt; 5 * 1024 * 1024) {
            showNotification(&#39;Image size should be less than 5MB&#39;, &#39;error&#39;);
            return;
        }
        
        // Show preview
        const reader = new FileReader();
        reader.onload = function(e) {
            if (previewElement) {
                previewElement.innerHTML = `&lt;img src=&#34;${e.target.result}&#34; style=&#34;max-width: 100%; max-height: 100%; border-radius: 5px;&#34;&gt;`;
            }
        };
        reader.readAsDataURL(file);
        
        // Upload to Cloudinary
        try {
            const imageUrl = await uploadToCloudinary(file);
            if (urlInputElement) {
                urlInputElement.value = imageUrl;
            }
        } catch (error) {
            console.error(&#39;Upload error:&#39;, error);
            showNotification(&#39;Failed to upload image: &#39; + error.message, &#39;error&#39;);
            if (urlInputElement) {
                urlInputElement.value = &#39;&#39;;
            }
        }
    });
}

// Initialize image uploads
function initializeImageUploads() {
    console.log(&#39; Initializing Cloudinary image upload...&#39;);
    
    // New product form
    setupImageUpload(
        document.getElementById(&#39;newProductImageUpload&#39;),
        document.getElementById(&#39;newProductImagePreview&#39;),
        document.getElementById(&#39;newProductImage&#39;)
    );
    
    // Edit product form
    setupImageUpload(
        document.getElementById(&#39;editProductImageUpload&#39;),
        document.getElementById(&#39;editProductImagePreview&#39;),
        document.getElementById(&#39;editProductImage&#39;)
    );
}

// Fixed Business Hours Check
function checkBusinessHours() {
    const now = new Date();
    const currentHour = now.getHours();
    const currentMinute = now.getMinutes();
    
    const currentTime = currentHour + currentMinute/60;
    
    // CORRECTED: Store opens at 10AM and closes at 10PM
    const openTime = 10; // 10:00 AM
    const closeTime = 22; // 10:00 PM
    
    if (currentTime &gt;= openTime &amp;&amp; currentTime &lt; closeTime) {
        openCheckoutModal();
    } else {
        businessHoursModal.style.display = &#39;flex&#39;;
    }
}

// ==================== GALLERY/CAMERA FUNCTIONS ====================

// Enhanced image upload setup with gallery option
function setupImageUpload(inputElement, previewElement, urlInputElement) {
    if (!inputElement) return;
    
    // Get the container
    const container = inputElement.closest(&#39;.file-upload-container&#39;);
    if (!container) return;
    
    // Remove existing file input label  new button create 
    const existingLabel = container.querySelector(&#39;.file-upload-label&#39;);
    if (existingLabel) {
        existingLabel.remove();
    }
    
    // Create new button with gallery/camera options
    const uploadButton = document.createElement(&#39;button&#39;);
    uploadButton.type = &#39;button&#39;;
    uploadButton.className = &#39;file-upload-label&#39;;
    uploadButton.innerHTML = `
        &lt;i class=&#34;fas fa-camera&#34;&gt;&lt;/i&gt;  Choose from Gallery
    `;
    uploadButton.onclick = function(e) {
        e.preventDefault();
        showImageSourceModal(inputElement, previewElement, urlInputElement);
    };
    
    // Insert button before the file input
    container.insertBefore(uploadButton, inputElement);
    
    // Hide the original file input
    inputElement.style.display = &#39;none&#39;;
}

// Image source selection modal
function showImageSourceModal(inputElement, previewElement, urlInputElement) {
    // Modal HTML create 
    const modalHTML = `
        &lt;div class=&#34;image-source-modal&#34; style=&#34;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        &#34;&gt;
            &lt;div style=&#34;
                background: white;
                padding: 30px;
                border-radius: 15px;
                text-align: center;
                max-width: 300px;
                width: 90%;
            &#34;&gt;
                &lt;h3 style=&#34;margin-bottom: 20px; color: #333;&#34;&gt;Choose Image Source&lt;/h3&gt;
                
                &lt;button onclick=&#34;chooseFromGallery()&#34; 
                    style=&#34;
                        background: linear-gradient(135deg, #2196F3, #0D47A1);
                        color: white;
                        border: none;
                        padding: 15px 20px;
                        border-radius: 10px;
                        font-size: 16px;
                        cursor: pointer;
                        width: 100%;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    &#34;&gt;
                    &lt;i class=&#34;fas fa-images&#34;&gt;&lt;/i&gt; Choose from Gallery
                &lt;/button&gt;
                
                &lt;button onclick=&#34;closeImageSourceModal()&#34; 
                    style=&#34;
                        background: #95a5a6;
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 8px;
                        cursor: pointer;
                        width: 100%;
                    &#34;&gt;
                    Cancel
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    `;
    
    // Modal add 
    const modalDiv = document.createElement(&#39;div&#39;);
    modalDiv.innerHTML = modalHTML;
    modalDiv.id = &#39;imageSourceModal&#39;;
    document.body.appendChild(modalDiv);
    
    // Store references for later use
    window.currentImageUploadData = {
        inputElement: inputElement,
        previewElement: previewElement,
        urlInputElement: urlInputElement
    };
}

// Close modal function
function closeImageSourceModal() {
    const modal = document.getElementById(&#39;imageSourceModal&#39;);
    if (modal) {
        document.body.removeChild(modal);
    }
    window.currentImageUploadData = null;
}

// Take photo with camera
function takePhotoWithCamera() {
    if (!window.currentImageUploadData) return;
    
    // Create camera input
    const cameraInput = document.createElement(&#39;input&#39;);
    cameraInput.type = &#39;file&#39;;
    cameraInput.accept = &#39;image/*&#39;;
    cameraInput.capture = &#39;environment&#39;;
    cameraInput.style.display = &#39;none&#39;;
    
    cameraInput.addEventListener(&#39;change&#39;, async function(e) {
        const file = e.target.files[0];
        if (!file) {
            closeImageSourceModal();
            return;
        }
        
        await processSelectedFile(file, window.currentImageUploadData.previewElement, window.currentImageUploadData.urlInputElement);
        closeImageSourceModal();
        document.body.removeChild(cameraInput);
    });
    
    document.body.appendChild(cameraInput);
    cameraInput.click();
}

// Choose from gallery
function chooseFromGallery() {
    if (!window.currentImageUploadData) return;
    
    // Create gallery input
    const galleryInput = document.createElement(&#39;input&#39;);
    galleryInput.type = &#39;file&#39;;
    galleryInput.accept = &#39;image/*&#39;;
    galleryInput.multiple = false;
    galleryInput.style.display = &#39;none&#39;;
    
    galleryInput.addEventListener(&#39;change&#39;, async function(e) {
        const file = e.target.files[0];
        if (!file) {
            closeImageSourceModal();
            return;
        }
        
        await processSelectedFile(file, window.currentImageUploadData.previewElement, window.currentImageUploadData.urlInputElement);
        closeImageSourceModal();
        document.body.removeChild(galleryInput);
    });
    
    document.body.appendChild(galleryInput);
    galleryInput.click();
}

// Process selected file (common for both camera and gallery)
async function processSelectedFile(file, previewElement, urlInputElement) {
    // Validate file type
    const validTypes = [&#39;image/jpeg&#39;, &#39;image/jpg&#39;, &#39;image/png&#39;, &#39;image/gif&#39;, &#39;image/webp&#39;];
    if (!validTypes.includes(file.type)) {
        showNotification(&#39;Please select a valid image file (JPEG, PNG, GIF, WebP)&#39;, &#39;error&#39;);
        return;
    }
    
    // Validate file size (5MB)
    if (file.size &gt; 5 * 1024 * 1024) {
        showNotification(&#39;Image size should be less than 5MB&#39;, &#39;error&#39;);
        return;
    }
    
    // Show preview
    const reader = new FileReader();
    reader.onload = function(e) {
        if (previewElement) {
            previewElement.innerHTML = `&lt;img src=&#34;${e.target.result}&#34; style=&#34;max-width: 100%; max-height: 100%; border-radius: 5px;&#34;&gt;`;
        }
    };
    reader.readAsDataURL(file);
    
    // Upload to Cloudinary
    try {
        const imageUrl = await uploadToCloudinary(file);
        if (urlInputElement) {
            urlInputElement.value = imageUrl;
        }
    } catch (error) {
        console.error(&#39;Upload error:&#39;, error);
        showNotification(&#39;Failed to upload image: &#39; + error.message, &#39;error&#39;);
        if (urlInputElement) {
            urlInputElement.value = &#39;&#39;;
        }
    }
}

// Updated initializeImageUploads function
function initializeImageUploads() {
    console.log(&#39; Initializing enhanced image upload with gallery...&#39;);
    
    // New product form
    setupImageUpload(
        document.getElementById(&#39;newProductImageUpload&#39;),
        document.getElementById(&#39;newProductImagePreview&#39;),
        document.getElementById(&#39;newProductImage&#39;)
    );
    
    // Edit product form
    setupImageUpload(
        document.getElementById(&#39;editProductImageUpload&#39;),
        document.getElementById(&#39;editProductImagePreview&#39;),
        document.getElementById(&#39;editProductImage&#39;)
    );
}

// ==================== API FUNCTIONS ====================

// API Utility Functions
const API_BASE_URL = &#39;https://sobjihaat-backend.onrender.com/api&#39;;

// Helper function for API calls
async function apiCall(endpoint, options = {}) {
    try {
        const headers = {
            &#39;Content-Type&#39;: &#39;application/json&#39;,
            ...(options.headers || {})
        };
        
        const requestOptions = {
            method: options.method || &#39;GET&#39;,
            headers: headers,
            mode: &#39;cors&#39;
        };
        
        if (options.body) {
            requestOptions.body = typeof options.body === &#39;string&#39; ? options.body : JSON.stringify(options.body);
        }
        
        const response = await fetch(`${API_BASE_URL}${endpoint}`, requestOptions);
        
        if (!response.ok) {
            const errorText = await response.text();
            throw new Error(errorText || &#39;Request failed&#39;);
        }
        
        return await response.json();
    } catch (error) {
        console.error(&#39; API Error:&#39;, error);
        throw error;
    }
}

// Products API
const productsAPI = {
    async getAll(category = null) {
        const endpoint = category ? `/products?category=${category}` : &#39;/products&#39;;
        return await apiCall(endpoint);
    },
    
    async getById(id) {
        return await apiCall(`/products/${id}`);
    },
    
    async create(product, token) {
        return await apiCall(&#39;/products&#39;, {
            method: &#39;POST&#39;,
            body: product,
            headers: {
                &#39;Authorization&#39;: `Bearer ${token}`
            }
        });
    },
    
    async update(id, product, token) {
        return await apiCall(`/products/${id}`, {
            method: &#39;PUT&#39;,
            body: product,
            headers: {
                &#39;Authorization&#39;: `Bearer ${token}`
            }
        });
    },
    
    async delete(id, token) {
        return await apiCall(`/products/${id}`, {
            method: &#39;DELETE&#39;,
            headers: {
                &#39;Authorization&#39;: `Bearer ${token}`
            }
        });
    },
    
    async updateStock(id, stock, token) {
        return await apiCall(`/products/${id}/stock`, {
            method: &#39;PUT&#39;,
            body: { stock: Number(stock) },
            headers: {
                &#39;Authorization&#39;: `Bearer ${token}`
            }
        });
    }
};

// Orders API
const ordersAPI = {
    async create(order) {
        return await apiCall(&#39;/orders&#39;, {
            method: &#39;POST&#39;,
            body: order
        });
    },
    
    async getAll(token) {
        return await apiCall(&#39;/orders&#39;, {
            headers: {
                &#39;Authorization&#39;: `Bearer ${token}`
            }
        });
    }
};

// Business Info API
const businessInfoAPI = {
    async get() {
        return await apiCall(&#39;/business-info&#39;);
    },
    
    async update(data, token) {
        return await apiCall(&#39;/business-info&#39;, {
            method: &#39;PUT&#39;,
            body: data,
            headers: {
                &#39;Authorization&#39;: `Bearer ${token}`
            }
        });
    }
};

// Admin API
const adminAPI = {
    async login(username, password) {
        return await apiCall(&#39;/admin/login&#39;, {
            method: &#39;POST&#39;,
            body: { username, password }
        });
    }
};

// Export for use in HTML
window.productsAPI = productsAPI;
window.ordersAPI = ordersAPI;
window.businessInfoAPI = businessInfoAPI;
window.adminAPI = adminAPI;
window.uploadToCloudinary = uploadToCloudinary;

// ==================== MAIN APPLICATION FUNCTIONS ====================

// Page navigation functions
function showHomePage() {
    document.querySelector(&#39;.main-app&#39;).style.display = &#39;block&#39;;
    document.getElementById(&#39;aboutPage&#39;).style.display = &#39;none&#39;;
    document.getElementById(&#39;adminPanel&#39;).style.display = &#39;none&#39;;
    closeAdminLogin();
}

function showAboutPage() {
    document.querySelector(&#39;.main-app&#39;).style.display = &#39;none&#39;;
    document.getElementById(&#39;aboutPage&#39;).style.display = &#39;block&#39;;
    document.getElementById(&#39;adminPanel&#39;).style.display = &#39;none&#39;;
    closeAdminLogin();
}

async function showAdminPanel() {
    document.querySelector(&#39;.main-app&#39;).style.display = &#39;none&#39;;
    document.getElementById(&#39;aboutPage&#39;).style.display = &#39;none&#39;;
    document.getElementById(&#39;adminPanel&#39;).style.display = &#39;block&#39;;
    closeAdminLogin();
    
    try {
        await loadAllProducts();
        loadAdminProducts();
        loadAdminSettings();
        await loadStockManagement();
    } catch (error) {
        console.error(&#39; Error loading admin panel:&#39;, error);
    }
}

function adminLogout() {
    adminToken = null;
    localStorage.removeItem(&#39;adminToken&#39;);
    document.getElementById(&#39;adminPanel&#39;).style.display = &#39;none&#39;;
    document.querySelector(&#39;.main-app&#39;).style.display = &#39;block&#39;;
}

// Initialize the app
document.addEventListener(&#39;DOMContentLoaded&#39;, async function() {
    try {
        // Check if admin is already logged in
        const savedToken = localStorage.getItem(&#39;adminToken&#39;);
        if (savedToken) {
            adminToken = savedToken;
        }
        
        // Load business info from API
        await loadBusinessInfo();
        
        // Load products from API
        await loadAllProducts();
        
        // Load initial category products
        await loadCategoryProducts(currentCategory);
        
        // Update offer banner
        updateOfferBanner();
        
        // Add emergency admin access
        setupEmergencyAdminAccess();
        
        // Initialize image uploads
        initializeImageUploads();
    } catch (error) {
        console.error(&#39;Error initializing app:&#39;, error);
    }
    
    setupEventListeners();
    updateCartCount();
    
    // Initialize reviews slider
    initReviewsSlider();
    
    // Initialize services slider
    initServicesSlider();
});

// Setup emergency admin access
function setupEmergencyAdminAccess() {
    let clickCount = 0;
    let clickTimer;
    
    document.querySelector(&#39;header&#39;).addEventListener(&#39;click&#39;, function(e) {
        if (e.target.classList.contains(&#39;nav-home&#39;)) {
            clickCount++;
            
            if (clickTimer) {
                clearTimeout(clickTimer);
            }
            
            clickTimer = setTimeout(function() {
                if (clickCount === 3) {
                    openAdminLogin();
                }
                clickCount = 0;
            }, 500);
        }
    });
}

// Load business info from API
async function loadBusinessInfo() {
    try {
        BUSINESS_INFO = await businessInfoAPI.get();
    } catch (error) {
        console.error(&#39; Error loading business info from API:&#39;, error);
        
        // Use fallback data
        BUSINESS_INFO = {
            name: &#34;Sabji Haat&#34;,
            phone: &#34;+919051410591&#34;, 
            address: &#34;Jadavpur Sandhya Bazar Rd, West Bengal Kolkata-700075&#34;,
            instagram: &#34;https://www.instagram.com/invites/contact/?utm_source=ig_contact_invite&amp;utm_medium=copy_link&amp;utm_content=seyxfz6&#34;,
            facebook: &#34;https://www.facebook.com/sabjihaat?mibextid=ZbWKwL&#34;,
            googleReview: &#34;https://maps.app.goo.gl/1DNV5UUPp2MXR81fA&#34;,
            packagingCharge: 10
        };
    }
}

// Load all products from API
async function loadAllProducts() {
    const categories = [&#39;indian&#39;, &#39;exotic&#39;, &#39;leafy&#39;, &#39;others&#39;, &#39;puja&#39;];
    
    for (const category of categories) {
        try {
            const products = await productsAPI.getAll(category);
            
            // Remove duplicates
            const uniqueProducts = [];
            const productIds = new Set();
            
            products.forEach(product =&gt; {
                if (!productIds.has(product.id)) {
                    productIds.add(product.id);
                    uniqueProducts.push(product);
                }
            });
            
            // Store in PRODUCTS object
            PRODUCTS[category] = uniqueProducts;
            
        } catch (error) {
            console.error(` Error loading ${category} products:`, error);
            PRODUCTS[category] = [];
        }
    }
}

// Set up event listeners
function setupEventListeners() {
    // Category buttons
    categoryButtons.forEach(button =&gt; {
        button.addEventListener(&#39;click&#39;, async function() {
            const category = this.getAttribute(&#39;data-category&#39;);
            if (!isLoading) {
                await loadCategory(category);
            }
        });
    });
 
    // Search functionality
    searchInput.addEventListener(&#39;input&#39;, function() {
        filterProducts(this.value);
        updateSearchIcon();
    });

    // Search icon click - focus on search input to open keyboard
    searchIcon.addEventListener(&#39;click&#39;, function() {
        searchInput.focus();
        if (searchInput.value.trim() !== &#39;&#39;) {
            filterProducts(searchInput.value);
        }
    });

    // Search bar focus - scroll to top
    searchInput.addEventListener(&#39;focus&#39;, function() {
        window.scrollTo(0, 0);
    });

    // Enter key support for search
    searchInput.addEventListener(&#39;keypress&#39;, function(e) {
        if (e.key === &#39;Enter&#39;) {
            e.preventDefault();
            filterProducts(this.value);
            this.blur();
            
            setTimeout(() =&gt; {
                const productsSection = document.querySelector(&#39;.products-container&#39;);
                if (productsSection) {
                    productsSection.scrollIntoView({ behavior: &#39;smooth&#39; });
                }
            }, 300);
        }
    });

    // Auto scroll to search bar when clicked
    document.addEventListener(&#39;click&#39;, function(e) {
        if (e.target.closest(&#39;.search-container&#39;) || e.target === searchInput || e.target === searchIcon) {
            const searchContainer = document.querySelector(&#39;.search-container&#39;);
            const headerHeight = document.querySelector(&#39;header&#39;).offsetHeight;
            
            window.scrollTo({
                top: searchContainer.offsetTop - headerHeight - 10,
                behavior: &#39;smooth&#39;
            });
            
            setTimeout(() =&gt; {
                searchInput.focus();
            }, 300);
        }
    });

    // Close cart when clicking outside
    cartModal.addEventListener(&#39;click&#39;, function(e) {
        if (e.target === cartModal) {
            closeCart();
        }
    });

    // Close checkout modal when clicking outside
    checkoutModal.addEventListener(&#39;click&#39;, function(e) {
        if (e.target === checkoutModal) {
            closeCheckoutModal();
        }
    });

    // Close business hours modal when clicking outside
    businessHoursModal.addEventListener(&#39;click&#39;, function(e) {
        if (e.target === businessHoursModal) {
            closeBusinessHoursModal();
        }
    });

    // Close admin login modal when clicking outside
    adminLoginModal.addEventListener(&#39;click&#39;, function(e) {
        if (e.target === adminLoginModal) {
            closeAdminLogin();
        }
    });

    // Admin login form
    adminLoginForm.addEventListener(&#39;submit&#39;, async function(e) {
        e.preventDefault();
        const username = document.getElementById(&#39;adminUsername&#39;).value;
        const password = document.getElementById(&#39;adminPassword&#39;).value;
        
        try {
            const response = await adminAPI.login(username, password);
            adminToken = response.token;
            localStorage.setItem(&#39;adminToken&#39;, adminToken);
            showAdminPanel();
        } catch (error) {
            console.error(&#39; Login error:&#39;, error);
            showNotification(&#39;Invalid credentials&#39;, &#39;error&#39;);
        }
    });
}

// Initialize services slider - UPDATED FOR 3 CARDS
function initServicesSlider() {
    const servicesContainer = document.getElementById(&#39;servicesContainer&#39;);
    const serviceCards = servicesContainer.querySelectorAll(&#39;.service-card&#39;);
    servicesTotalSlides = Math.ceil(serviceCards.length / 3) - 1;
    
    // Create dots
    createServicesDots();
    
    // Start auto sliding
    startServicesAutoSlide();
    
    // Pause auto slide on hover
    servicesContainer.addEventListener(&#39;mouseenter&#39;, () =&gt; {
        clearInterval(servicesAutoSlideInterval);
    });
    
    // Resume auto slide when mouse leaves
    servicesContainer.addEventListener(&#39;mouseleave&#39;, () =&gt; {
        startServicesAutoSlide();
    });
}

// Create dots for services slider
function createServicesDots() {
    const dotsContainer = document.getElementById(&#39;servicesDots&#39;);
    dotsContainer.innerHTML = &#39;&#39;;
    
    for (let i = 0; i &lt;= servicesTotalSlides; i++) {
        const dot = document.createElement(&#39;div&#39;);
        dot.className = `services-dot ${i === 0 ? &#39;active&#39; : &#39;&#39;}`;
        dot.addEventListener(&#39;click&#39;, () =&gt; {
            goToServicesSlide(i);
        });
        dotsContainer.appendChild(dot);
    }
}

// Slide services - UPDATED FOR 3 CARDS
function slideServices(direction) {
    if (direction === &#39;next&#39;) {
        servicesCurrentSlide = Math.min(servicesCurrentSlide + 1, servicesTotalSlides);
    } else {
        servicesCurrentSlide = Math.max(servicesCurrentSlide - 1, 0);
    }
    
    updateServicesSlider();
}

// Go to specific slide
function goToServicesSlide(slideIndex) {
    servicesCurrentSlide = slideIndex;
    updateServicesSlider();
}

// Update services slider position - UPDATED FOR 3 CARDS
function updateServicesSlider() {
    const servicesContainer = document.getElementById(&#39;servicesContainer&#39;);
    const translateX = -servicesCurrentSlide * 100;
    servicesContainer.style.transform = `translateX(${translateX}%)`;
    
    // Update active dot
    const dots = document.querySelectorAll(&#39;.services-dot&#39;);
    dots.forEach((dot, index) =&gt; {
        dot.classList.toggle(&#39;active&#39;, index === servicesCurrentSlide);
    });
    
    // Reset auto slide timer
    resetServicesAutoSlide();
}

// Start auto sliding for services
function startServicesAutoSlide() {
    servicesAutoSlideInterval = setInterval(() =&gt; {
        if (servicesCurrentSlide &gt;= servicesTotalSlides) {
            servicesCurrentSlide = 0;
        } else {
            servicesCurrentSlide++;
        }
        updateServicesSlider();
    }, 4000);
}

// Reset auto slide timer
function resetServicesAutoSlide() {
    clearInterval(servicesAutoSlideInterval);
    startServicesAutoSlide();
}

// Initialize reviews slider
function initReviewsSlider() {
    const reviewCards = document.querySelectorAll(&#39;.review-card&#39;);
    reviewsTotalSlides = Math.ceil(reviewCards.length / 3) - 1;
    
    // Start auto sliding for reviews
    startReviewsAutoSlide();
    
    // Pause auto slide on hover
    const reviewContainer = document.getElementById(&#39;reviewContainer&#39;);
    reviewContainer.addEventListener(&#39;mouseenter&#39;, () =&gt; {
        clearInterval(reviewsAutoSlideInterval);
    });
    
    // Resume auto slide when mouse leaves
    reviewContainer.addEventListener(&#39;mouseleave&#39;, () =&gt; {
        startReviewsAutoSlide();
    });
    
    // Initialize counter animation
    const countElem = document.getElementById(&#39;happyCount&#39;);
    let count = 0;
    const target = 1200;
    const increment = Math.ceil(target / 100);

    function countUp() {
        if (count &lt; target) {
            count += increment;
            countElem.textContent = count &gt; target ? target : count;
            requestAnimationFrame(countUp);
        }
    }
    countUp();
    
    // Initialize card animations
    reviewCards.forEach((card, index) =&gt; {
        setTimeout(() =&gt; {
            card.classList.add(&#39;visible&#39;);
        }, index * 200);
    });
}

// Slide reviews
function slideReviews(direction) {
    if (direction === &#39;next&#39;) {
        reviewsCurrentSlide = Math.min(reviewsCurrentSlide + 1, reviewsTotalSlides);
    } else {
        reviewsCurrentSlide = Math.max(reviewsCurrentSlide - 1, 0);
    }
    
    updateReviewsSlider();
}

// Update reviews slider position
function updateReviewsSlider() {
    const reviewContainer = document.getElementById(&#39;reviewContainer&#39;);
    const translateX = -reviewsCurrentSlide * 100;
    reviewContainer.style.transform = `translateX(${translateX}%)`;
    
    // Reset auto slide timer
    resetReviewsAutoSlide();
}

// Start auto sliding for reviews
function startReviewsAutoSlide() {
    reviewsAutoSlideInterval = setInterval(() =&gt; {
        if (reviewsCurrentSlide &gt;= reviewsTotalSlides) {
            reviewsCurrentSlide = 0;
        } else {
            reviewsCurrentSlide++;
        }
        updateReviewsSlider();
    }, 5000);
}

// Reset auto slide timer for reviews
function resetReviewsAutoSlide() {
    clearInterval(reviewsAutoSlideInterval);
    startReviewsAutoSlide();
}

// Update search icon based on input
function updateSearchIcon() {
    if (searchInput.value.trim() !== &#39;&#39;) {
        searchIcon.className = &#39;search-icon fas fa-times&#39;;
        searchIcon.onclick = function() {
            searchInput.value = &#39;&#39;;
            filterProducts(&#39;&#39;);
            updateSearchIcon();
            searchInput.blur();
        };
    } else {
        searchIcon.className = &#39;search-icon fas fa-search&#39;;
        searchIcon.onclick = function() {
            searchInput.focus();
            filterProducts(searchInput.value);
        };
    }
}

// Load category
async function loadCategory(category) {
    if (isLoading) {
        categoryLoadQueue.push(category);
        return;
    }
    
    productsVisible = true;
    productsContainer.style.display = &#39;grid&#39;;
    setActiveCategory(category);
    
    isLoading = true;
    
    try {
        await loadCategoryProducts(category);
        currentCategory = category;
    } catch (error) {
        console.error(`Error loading ${category} products:`, error);
    } finally {
        isLoading = false;
        
        if (categoryLoadQueue.length &gt; 0) {
            const nextCategory = categoryLoadQueue.shift();
            setTimeout(() =&gt; loadCategory(nextCategory), 300);
        }
    }
}

// Set active category
function setActiveCategory(category) {
    // Update category buttons
    categoryButtons.forEach(button =&gt; {
        button.classList.remove(&#39;active&#39;);
        if (button.getAttribute(&#39;data-category&#39;) === category) {
            button.classList.add(&#39;active&#39;);
        }
    });
    
    // Update category images
    categoryImages.forEach(image =&gt; {
        image.classList.remove(&#39;active&#39;);
        if (image.getAttribute(&#39;data-category&#39;) === category) {
            image.classList.add(&#39;active&#39;);
        }
    });
}

// Load products for a specific category
async function loadCategoryProducts(category) {
    let products = [];
    
    // Check if we already have products for this category
    if (PRODUCTS[category] &amp;&amp; PRODUCTS[category].length &gt; 0) {
        products = PRODUCTS[category];
    } else {
        // Load from API if not cached
        try {
            const response = await fetch(`${API_BASE_URL}/products/cached?category=${category}`);
            
            if (response.ok) {
                products = await response.json();
                
                // Remove duplicates
                const uniqueProducts = [];
                const productIds = new Set();
                
                products.forEach(product =&gt; {
                    if (!productIds.has(product.id)) {
                        productIds.add(product.id);
                        uniqueProducts.push(product);
                    }
                });
                
                products = uniqueProducts;
                
                // Cache the products
                PRODUCTS[category] = products;
                
            } else {
                products = [];
            }
        } catch (error) {
            console.error(` Error loading ${category} products:`, error);
            products = [];
        }
    }
    
    // Sort products: in-stock first
    products = products.sort((a, b) =&gt; {
        const stockA = a.stock ?? 0;
        const stockB = b.stock ?? 0;
        const isOutOfStockA = stockA &lt;= 0;
        const isOutOfStockB = stockB &lt;= 0;
        
        if (isOutOfStockA === isOutOfStockB) {
            return a.name.localeCompare(b.name);
        }
        return isOutOfStockA ? 1 : -1;
    });
    
    // Clear container and render
    productsContainer.innerHTML = &#39;&#39;;
    
    if (products.length === 0) {
        productsContainer.innerHTML = `
            &lt;div style=&#34;grid-column: 1 / -1; text-align: center; padding: 40px; color: #666;&#34;&gt;
                &lt;i class=&#34;fas fa-box-open&#34; style=&#34;font-size: 48px; margin-bottom: 15px; opacity: 0.5;&#34;&gt;&lt;/i&gt;
                &lt;p&gt;No products found in ${category} category&lt;/p&gt;
                &lt;button onclick=&#34;loadCategory(&#39;${category}&#39;)&#34; style=&#34;
                    background: linear-gradient(135deg, #4CAF50, #2E7D32);
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 8px;
                    margin-top: 10px;
                    cursor: pointer;
                &#34;&gt;
                    &lt;i class=&#34;fas fa-sync-alt&#34;&gt;&lt;/i&gt; Retry Loading
                &lt;/button&gt;
            &lt;/div&gt;
        `;
        return;
    }
    
    // Render all products at once
    for (let i = 0; i &lt; products.length; i++) {
        renderSingleProduct(products[i], i);
    }
}

// Render single product with animation
async function renderSingleProduct(product, index) {
    const quantityOptions = getQuantityOptions(product.unit);
    const stockValue = product.stock ?? 0;
    const isOutOfStock = stockValue &lt;= 0;
    
    const productCard = document.createElement(&#39;div&#39;);
    productCard.className = &#39;product-card fast-load&#39;;
    productCard.style.animationDelay = (index * 50) + &#39;ms&#39;;
    productCard.innerHTML = `
        ${isOutOfStock ? &#39;&lt;div class=&#34;out-of-stock&#34;&gt;&lt;/div&gt;&#39; : &#39;&#39;}
        ${stockValue &lt; 10 &amp;&amp; stockValue &gt; 0 ? `&lt;div class=&#34;stock-badge&#34;&gt;Low Stock&lt;/div&gt;` : &#39;&#39;}
        &lt;img 
            src=&#34;${product.image}&#34; 
            alt=&#34;${product.name}&#34; 
            class=&#34;product-image&#34; 
            loading=&#34;lazy&#34;
            onload=&#34;this.classList.remove(&#39;lazy-image&#39;)&#34;
            onerror=&#34;this.src=&#39;https://via.placeholder.com/300x200?text=Sabji+Haat&#39;&#34;
        &gt;
        &lt;div class=&#34;product-info&#34;&gt;
            &lt;div class=&#34;product-name&#34;&gt;${product.name}&lt;/div&gt;
            &lt;div class=&#34;product-price&#34;&gt;${product.price}&lt;span class=&#34;unit-display&#34;&gt;/${product.unit}&lt;/span&gt;&lt;/div&gt;
            &lt;div class=&#34;quantity-selector&#34;&gt;
                &lt;div class=&#34;quantity-options ${isOutOfStock ? &#39;disabled&#39; : &#39;&#39;}&#34; id=&#34;quantity-options-${product.id}&#34;&gt;
                    ${quantityOptions.map(option =&gt; `
                        &lt;div class=&#34;quantity-option&#34; data-value=&#34;${option.value}&#34; data-product=&#34;${product.id}&#34; ${isOutOfStock ? &#39;style=&#34;pointer-events: none; opacity: 0.5;&#34;&#39; : &#39;&#39;}&gt;
                            ${option.label}
                        &lt;/div&gt;
                    `).join(&#39;&#39;)}
                &lt;/div&gt;
                &lt;div class=&#34;custom-quantity&#34;&gt;
                    &lt;input type=&#34;number&#34; class=&#34;custom-quantity-input&#34; id=&#34;custom-quantity-${product.id}&#34; 
                           placeholder=&#34;Custom&#34; min=&#34;0.1&#34; step=&#34;0.1&#34; oninput=&#34;validateNumberInput(this)&#34; 
                           ${isOutOfStock ? &#39;disabled&#39; : &#39;&#39;}&gt;
                    &lt;span class=&#34;custom-quantity-unit&#34;&gt;${product.unit}&lt;/span&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;button class=&#34;add-to-cart&#34; onclick=&#34;addToCart(${product.id})&#34; ${isOutOfStock ? &#39;disabled&#39; : &#39;&#39;}&gt;
                ${isOutOfStock ? &#39;Currently Not Available&#39; : &#39;Add to Cart&#39;}
            &lt;/button&gt;
        &lt;/div&gt;
    `;
    
    // Add to container
    productsContainer.appendChild(productCard);
    
    // Setup event listeners
    setTimeout(() =&gt; {
        setupProductEventListeners(product.id, isOutOfStock);
    }, 100);
}

// New function to setup product event listeners
function setupProductEventListeners(productId, isOutOfStock) {
    const optionsContainer = document.getElementById(`quantity-options-${productId}`);
    if (optionsContainer) {
        const options = optionsContainer.querySelectorAll(&#39;.quantity-option&#39;);
        const customInput = document.getElementById(`custom-quantity-${productId}`);
        
        options.forEach(option =&gt; {
            option.addEventListener(&#39;click&#39;, function() {
                if (isOutOfStock) {
                    showNotification(&#39;This product is currently not available&#39;, &#39;error&#39;);
                    return;
                }
                
                options.forEach(opt =&gt; opt.classList.remove(&#39;active&#39;));
                this.classList.add(&#39;active&#39;);
                
                const quantity = parseFloat(this.getAttribute(&#39;data-value&#39;));
                selectedQuantities[productId] = quantity;
                
                if (customInput) {
                    customInput.value = &#39;&#39;;
                }
            });
        });
        
        if (customInput) {
            customInput.addEventListener(&#39;input&#39;, function() {
                const customValue = parseFloat(this.value);
                if (!isNaN(customValue) &amp;&amp; customValue &gt; 0) {
                    options.forEach(opt =&gt; opt.classList.remove(&#39;active&#39;));
                    selectedQuantities[productId] = customValue;
                } else {
                    selectedQuantities[productId] = 0;
                }
            });
        }
    }
}

// Validate number input to allow only numbers
function validateNumberInput(input) {
    input.value = input.value.replace(/[^0-9.]/g, &#39;&#39;);
    
    if ((input.value.match(/\./g) || []).length &gt; 1) {
        input.value = input.value.substring(0, input.value.lastIndexOf(&#39;.&#39;));
    }
    
    const value = parseFloat(input.value);
    if (!isNaN(value) &amp;&amp; value &gt; 0) {
        const roundedValue = Math.round(value * 10) / 10;
        input.value = roundedValue;
        selectedQuantities[input.id.replace(&#39;custom-quantity-&#39;, &#39;&#39;)] = roundedValue;
    }
}

// Filter products based on search - searches across all categories
function filterProducts(searchTerm) {
    if (searchTerm.trim() === &#39;&#39;) {
        loadCategoryProducts(currentCategory);
        return;
    }
    
    const allProducts = [];
    for (const category in PRODUCTS) {
        allProducts.push(...PRODUCTS[category]);
    }
    
    let filteredProducts = allProducts.filter(product =&gt; 
        product.name.toLowerCase().includes(searchTerm.toLowerCase())
    );
    
    // Remove duplicates
    const uniqueProducts = [];
    const productIds = new Set();
    
    filteredProducts.forEach(product =&gt; {
        if (!productIds.has(product.id)) {
            productIds.add(product.id);
            uniqueProducts.push(product);
        }
    });
    
    filteredProducts = uniqueProducts;
    
    // Sort by stock status
    filteredProducts = filteredProducts.sort((a, b) =&gt; {
        const stockA = a.stock ?? 0;
        const stockB = b.stock ?? 0;
        const isOutOfStockA = stockA &lt;= 0;
        const isOutOfStockB = stockB &lt;= 0;
        
        if (isOutOfStockA === isOutOfStockB) {
            return 0;
        }
        return isOutOfStockA ? 1 : -1;
    });
    
    productsContainer.innerHTML = &#39;&#39;;
    
    if (filteredProducts.length === 0) {
        productsContainer.innerHTML = &#39;&lt;div style=&#34;grid-column: 1 / -1; text-align: center; padding: 20px; color: #666;&#34;&gt;No products found matching your search&lt;/div&gt;&#39;;
        return;
    }
    
    // Load filtered products
    for (let i = 0; i &lt; filteredProducts.length; i++) {
        renderSingleProduct(filteredProducts[i], i);
    }
}

// Add product to cart
function addToCart(productId) {
    if (!selectedQuantities[productId] || selectedQuantities[productId] === 0) {
        showNotification(&#39;Please select quantity first&#39;);
        return;
    }
    
    const quantity = selectedQuantities[productId];
    
    let product = null;
    for (const category in PRODUCTS) {
        product = PRODUCTS[category].find(p =&gt; p.id === productId);
        if (product) break;
    }
    
    if (!product) return;
    
    const stockValue = product.stock ?? 0;
    if (stockValue &lt;= 0) {
        showNotification(&#39;Sorry, this product is currently not available&#39;, &#39;error&#39;);
        return;
    }
    
    if (quantity &gt; stockValue) {
        showNotification(`Only ${stockValue} ${product.unit} available`, &#39;error&#39;);
        return;
    }
    
    const existingItemIndex = cart.findIndex(item =&gt; item.id === productId);
    
    if (existingItemIndex !== -1) {
        cart[existingItemIndex].quantity += quantity;
    } else {
        cart.push({
            id: product.id,
            name: product.name,
            price: product.price,
            quantity: quantity,
            unit: product.unit
        });
    }
    
    const newStock = Math.max(0, (product.stock ?? 0) - quantity);
    product.stock = newStock;
    
    selectedQuantities[productId] = 0;
    
    const optionsContainer = document.getElementById(`quantity-options-${productId}`);
    if (optionsContainer) {
        const options = optionsContainer.querySelectorAll(&#39;.quantity-option&#39;);
        options.forEach(opt =&gt; opt.classList.remove(&#39;active&#39;));
    }
    
    const customInput = document.getElementById(`custom-quantity-${productId}`);
    if (customInput) {
        customInput.value = &#39;&#39;;
    }
    
    updateCartCount();
    showNotification(`${product.name} added to cart`);
    
    loadCategoryProducts(currentCategory);
}

// Update cart count in the UI
function updateCartCount() {
    const totalItems = cart.reduce((total, item) =&gt; total + item.quantity, 0);
    cartCount.textContent = Math.round(totalItems * 10) / 10;
}

// Open cart modal
function openCart() {
    renderCartItems();
    cartModal.style.display = &#39;flex&#39;;
}

// Close cart modal
function closeCart() {
    cartModal.style.display = &#39;none&#39;;
}

// Render cart items in the modal
function renderCartItems() {
    cartItems.innerHTML = &#39;&#39;;
    
    if (cart.length === 0) {
        cartItems.innerHTML = &#39;&lt;div class=&#34;empty-cart&#34;&gt;Your cart is empty&lt;/div&gt;&#39;;
        cartTotal.textContent = &#39;Total: 0&#39;;
        return;
    }
    
    let subtotal = 0;
    
    cart.forEach(item =&gt; {
        const itemTotal = item.price * item.quantity;
        subtotal += itemTotal;
        
        const cartItem = document.createElement(&#39;div&#39;);
        cartItem.className = &#39;cart-item&#39;;
        cartItem.innerHTML = `
            &lt;div class=&#34;cart-item-info&#34;&gt;
                &lt;div class=&#34;cart-item-name&#34;&gt;${item.name}&lt;/div&gt;
                &lt;div class=&#34;cart-item-price&#34;&gt;${item.price}/${item.unit}  ${item.quantity}${getUnitDisplay(item.unit)} = ${itemTotal.toFixed(2)}&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&#34;cart-item-actions&#34;&gt;
                &lt;button class=&#34;quantity-btn minus&#34; onclick=&#34;updateCartItemQuantity(${item.id}, -${getQuantityStep(item.unit)})&#34;&gt;-&lt;/button&gt;
                &lt;span class=&#34;quantity&#34;&gt;${item.quantity}${getUnitDisplay(item.unit)}&lt;/span&gt;
                &lt;button class=&#34;quantity-btn plus&#34; onclick=&#34;updateCartItemQuantity(${item.id}, ${getQuantityStep(item.unit)})&#34;&gt;+&lt;/button&gt;
                &lt;button class=&#34;quantity-btn remove&#34; onclick=&#34;removeFromCart(${item.id})&#34; style=&#34;background: #e74c3c;&#34;&gt;
                    &lt;i class=&#34;fas fa-trash&#34;&gt;&lt;/i&gt;
                &lt;/button&gt;
            &lt;/div&gt;
        `;
        cartItems.appendChild(cartItem);
    });
    
    // Calculate packaging charge
    const packagingCharge = BUSINESS_INFO.packagingCharge || 10;
    const total = subtotal + packagingCharge;
    
    cartTotal.innerHTML = `
        &lt;div class=&#34;billing-row&#34;&gt;
            &lt;span&gt;Subtotal:&lt;/span&gt;
            &lt;span&gt;${subtotal.toFixed(2)}&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class=&#34;billing-row&#34;&gt;
            &lt;span&gt;Packaging Charge:&lt;/span&gt;
            &lt;span&gt;${packagingCharge}&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class=&#34;billing-row billing-total&#34;&gt;
            &lt;span&gt;Total:&lt;/span&gt;
            &lt;span&gt;${total.toFixed(2)}&lt;/span&gt;
        &lt;/div&gt;
    `;
}

// Get unit display for cart
function getUnitDisplay(unit) {
    switch(unit) {
        case &#39;piece&#39;:
        case &#39;bunch&#39;:
        case &#39;packet&#39;:
        case &#39;tin&#39;:
        case &#39;bottle&#39;:
            return &#39;&#39;;
        case &#39;kg&#39;:
            return &#39;kg&#39;;
        default:
            return &#39;&#39;;
    }
}

// Get quantity step based on unit
function getQuantityStep(unit) {
    switch(unit) {
        case &#39;piece&#39;:
        case &#39;bunch&#39;:
        case &#39;packet&#39;:
        case &#39;tin&#39;:
        case &#39;bottle&#39;:
            return 1;
        case &#39;kg&#39;:
            return 0.1;
        default:
            return 1;
    }
}

// Update cart item quantity
function updateCartItemQuantity(productId, change) {
    const itemIndex = cart.findIndex(item =&gt; item.id === productId);
    
    if (itemIndex !== -1) {
        let product = null;
        for (const category in PRODUCTS) {
            product = PRODUCTS[category].find(p =&gt; p.id === productId);
            if (product) break;
        }
        
        if (!product) return;
        
        const stockValue = product.stock ?? 0;
        const newQuantity = cart[itemIndex].quantity + change;
        
        if (newQuantity &lt;= 0) {
            cart.splice(itemIndex, 1);
        } else if (newQuantity &gt; stockValue + cart[itemIndex].quantity) {
            showNotification(`Only ${stockValue + cart[itemIndex].quantity} ${product.unit} available`, &#39;error&#39;);
            return;
        } else {
            cart[itemIndex].quantity = newQuantity;
            product.stock = stockValue - change;
        }
        
        updateCartCount();
        renderCartItems();
        
        loadCategoryProducts(currentCategory);
    }
}

// Remove item from cart
function removeFromCart(productId) {
    const itemIndex = cart.findIndex(item =&gt; item.id === productId);
    
    if (itemIndex !== -1) {
        let product = null;
        for (const category in PRODUCTS) {
            product = PRODUCTS[category].find(p =&gt; p.id === productId);
            if (product) break;
        }
        
        if (product) {
            product.stock = (product.stock ?? 0) + cart[itemIndex].quantity;
        }
        
        cart.splice(itemIndex, 1);
        updateCartCount();
        renderCartItems();
        
        loadCategoryProducts(currentCategory);
    }
}

// Open checkout modal
function openCheckoutModal() {
    if (cart.length === 0) {
        showNotification(&#39;Your cart is empty&#39;);
        return;
    }
    
    renderBillingSummary();
    checkoutModal.style.display = &#39;flex&#39;;
}

// Close checkout modal
function closeCheckoutModal() {
    checkoutModal.style.display = &#39;none&#39;;
}

// Close business hours modal
function closeBusinessHoursModal() {
    businessHoursModal.style.display = &#39;none&#39;;
}

// Render billing summary
function renderBillingSummary() {
    let subtotal = 0;
    
    cart.forEach(item =&gt; {
        const itemTotal = item.price * item.quantity;
        subtotal += itemTotal;
    });
    
    const packagingCharge = BUSINESS_INFO.packagingCharge || 10;
    const total = subtotal + packagingCharge;
    
    billingSummary.innerHTML = `
        &lt;h3&gt;Order Summary&lt;/h3&gt;
        ${cart.map(item =&gt; `
            &lt;div class=&#34;billing-row&#34;&gt;
                &lt;span&gt;${item.name} (${item.quantity}${getUnitDisplay(item.unit)})&lt;/span&gt;
                &lt;span&gt;${(item.price * item.quantity).toFixed(2)}&lt;/span&gt;
            &lt;/div&gt;
        `).join(&#39;&#39;)}
        &lt;div class=&#34;billing-row&#34;&gt;
            &lt;span&gt;Subtotal:&lt;/span&gt;
            &lt;span&gt;${subtotal.toFixed(2)}&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class=&#34;billing-row&#34;&gt;
            &lt;span&gt;Packaging Charge:&lt;/span&gt;
            &lt;span&gt;${packagingCharge}&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class=&#34;billing-row billing-total&#34;&gt;
            &lt;span&gt;Total:&lt;/span&gt;
            &lt;span&gt;${total.toFixed(2)}&lt;/span&gt;
        &lt;/div&gt;
    `;
}

// Validate and process checkout
function validateAndCheckout() {
    const name = document.getElementById(&#39;customerName&#39;).value;
    const phone = document.getElementById(&#39;customerPhone&#39;).value;
    
    if (!name || !phone) {
        showNotification(&#39;Please fill all required fields&#39;, &#39;error&#39;);
        return;
    }
    
    if (phone.length &lt; 10) {
        showNotification(&#39;Please enter a valid phone number&#39;, &#39;error&#39;);
        return;
    }
    
    processCheckout(name, phone);
}

// Update the processCheckout function to include order number and payment instructions
async function processCheckout(name, phone) {
    try {
        let subtotal = 0;
        const orderItems = cart.map(item =&gt; {
            const itemTotal = item.price * item.quantity;
            subtotal += itemTotal;
            return {
                productId: item.id,
                name: item.name,
                price: item.price,
                quantity: item.quantity,
                unit: item.unit
            };
        });
        
        const packagingCharge = BUSINESS_INFO.packagingCharge || 10;
        const total = subtotal + packagingCharge;
        
        // Save order to backend
        let savedOrder = null;
        try {
            savedOrder = await ordersAPI.create({
                customerName: name,
                customerPhone: phone,
                address: &#34;Store Pickup&#34;,
                pincode: &#34;700075&#34;,
                items: orderItems,
                subtotal: subtotal,
                deliveryFee: 0,
                total: total
            });
        } catch (error) {
            console.error(&#39;Error saving order:&#39;, error);
            // Generate local order ID if API fails
            const date = new Date();
            const dateStr = date.toISOString().slice(0, 10).replace(/-/g, &#39;&#39;);
            const orderNumber = Math.floor(Math.random() * 1000) + 1;
            savedOrder = { orderId: `ORD${dateStr}-${orderNumber.toString().padStart(4, &#39;0&#39;)}` };
        }
        
        // Prepare order message for WhatsApp
        let message = `*${BUSINESS_INFO.name} - New Order*\n\n`;
        message += `* Order ID:* ${savedOrder.orderId}\n`;
        message += `* Order Date:* ${new Date().toLocaleDateString(&#39;en-IN&#39;)}\n\n`;
        
        message += `* Customer Details:*\n`;
        message += `Name: ${name}\n`;
        message += `Phone: ${phone}\n`;
        message += `Pickup: Store Pickup\n`;
        message += `Payment: Cash on Pickup\n\n`;
        
        message += `* Order Items:*\n`;
        cart.forEach(item =&gt; {
            const itemTotal = item.price * item.quantity;
            message += ` ${item.name} - ${item.quantity}${getUnitDisplay(item.unit)}  ${item.price} = ${itemTotal.toFixed(2)}\n`;
        });
        
        message += `\n* Order Summary:*\n`;
        message += `Subtotal: ${subtotal.toFixed(2)}\n`;
        message += `Packaging Charge: ${packagingCharge}\n`;
        message += `*Total Amount: ${total.toFixed(2)}*\n\n`;
        
        message += `* Pickup Information:*\n`;
        message += `Your order will be ready for pickup at:\n`;
        message += `${BUSINESS_INFO.address}\n\n`;
        
        message += `* IMPORTANT PAYMENT INSTRUCTIONS:*\n`;
        message += `1 Your order will be confirmed only after 50% advance payment\n`;
        message += `2 Please send ${(total * 0.5).toFixed(2)} as advance payment\n`;
        message += `3 Payment methods: GPay/PhonePe/UPI: ${BUSINESS_INFO.phone}\n`;
        message += `4 Send payment screenshot immediately after this message\n`;
        message += `5 Pickup time will be shared after payment confirmation\n\n`;
        
        message += `* Order Confirmation Steps:*\n`;
        message += `1. Add items to cart on website\n`;
        message += `2. Send order details via WhatsApp (this message)\n`;
        message += `3. Send 50% advance payment screenshot\n`;
        message += `4. Wait for order confirmation message\n`;
        message += `5. Collect order from store with remaining payment\n\n`;
        
        message += `*Order ID for reference: ${savedOrder.orderId}*\n`;
        message += `Thank you for choosing Sabji Haat! `;
        
        const encodedMessage = encodeURIComponent(message);
        const whatsappUrl = `https://wa.me/${BUSINESS_INFO.phone.replace(&#39;+&#39;, &#39;&#39;)}?text=${encodedMessage}`;
        
        // Open WhatsApp
        window.open(whatsappUrl, &#39;_blank&#39;);
        
        // Clear cart
        cart = [];
        updateCartCount();
        closeCheckoutModal();
        closeCart();
        
        // Reload products
        await loadAllProducts();
        loadCategoryProducts(currentCategory);
        
        showNotification(`Order sent to WhatsApp! Please send 50% advance payment screenshot.`, &#39;success&#39;);
    } catch (error) {
        console.error(&#39;Error processing checkout:&#39;, error);
        showNotification(&#39;Error processing order. Please try again.&#39;, &#39;error&#39;);
    }
}

// Show notification
function showNotification(message, type = &#39;success&#39;) {
    notification.textContent = message;
    notification.style.background = type === &#39;success&#39; ? &#39;#2ecc71&#39; : &#39;#e74c3c&#39;;
    notification.style.display = &#39;block&#39;;
    
    setTimeout(() =&gt; {
        notification.style.display = &#39;none&#39;;
    }, 3000);
}

// Social media functions
function openWhatsApp() {
    window.open(`https://wa.me/${BUSINESS_INFO.phone.replace(&#39;+&#39;, &#39;&#39;)}`, &#39;_blank&#39;);
}

function openFacebook() {
    window.open(BUSINESS_INFO.facebook, &#39;_blank&#39;);
}

function openInstagram() {
    window.open(BUSINESS_INFO.instagram, &#39;_blank&#39;);
}

function openGoogleReview() {
    window.open(&#34;https://maps.app.goo.gl/1DNV5UUPp2MXR81fA&#34;, &#39;_blank&#39;);
}

// Services section functions
function openServiceWhatsApp(serviceType) {
    const message = `Hello Sabji Haat! I&#39;m interested in your ${serviceType} service. Please provide me with more details.`;
    const encodedMessage = encodeURIComponent(message);
    const whatsappUrl = `https://wa.me/${BUSINESS_INFO.phone.replace(&#39;+&#39;, &#39;&#39;)}?text=${encodedMessage}`;
    window.open(whatsappUrl, &#39;_blank&#39;);
}

// Update offer banner
function updateOfferBanner() {
    offerBanner.innerHTML = `
         For Bulk Orders at Wholesale Rate : +919051410591
    `;
}

// Admin functions
function startHomePress() {
    homePressTimer = setTimeout(function() {
        openAdminLogin();
    }, 10000);
}

function endHomePress() {
    if (homePressTimer) {
        clearTimeout(homePressTimer);
        homePressTimer = null;
    }
}

function openAdminLogin() {
    adminLoginModal.style.display = &#39;flex&#39;;
}

function closeAdminLogin() {
    adminLoginModal.style.display = &#39;none&#39;;
    document.getElementById(&#39;adminUsername&#39;).value = &#39;&#39;;
    document.getElementById(&#39;adminPassword&#39;).value = &#39;&#39;;
}

function switchAdminTab(tabName) {
    document.querySelectorAll(&#39;.admin-tab-content&#39;).forEach(tab =&gt; {
        tab.classList.remove(&#39;active&#39;);
    });
    
    document.querySelectorAll(&#39;.admin-tab&#39;).forEach(button =&gt; {
        button.classList.remove(&#39;active&#39;);
    });
    
    const tabElement = document.getElementById(tabName + &#39;Tab&#39;);
    if (tabElement) {
        tabElement.classList.add(&#39;active&#39;);
    }
    
    if (event &amp;&amp; event.target) {
        event.target.classList.add(&#39;active&#39;);
    }
    
    if (tabName === &#39;stock&#39;) {
        loadStockManagement().catch(err =&gt; {
            console.error(&#39;Error loading stock management:&#39;, err);
        });
    } else if (tabName === &#39;products&#39;) {
        loadAdminProducts();
    } else if (tabName === &#39;settings&#39;) {
        loadAdminSettings();
    }
}

async function loadAdminProducts() {
    const productList = document.getElementById(&#39;adminProductList&#39;);
    productList.innerHTML = &#39;&lt;div class=&#34;loading&#34;&gt;Loading products...&lt;/div&gt;&#39;;
    
    try {
        await loadAllProducts();
        
        productList.innerHTML = &#39;&#39;;
        let totalProducts = 0;
        
        for (const category in PRODUCTS) {
            PRODUCTS[category].forEach(product =&gt; {
                totalProducts++;
                const productItem = document.createElement(&#39;div&#39;);
                productItem.className = &#39;admin-product-item&#39;;
                productItem.innerHTML = `
                    &lt;div class=&#34;admin-product-info&#34;&gt;
                        &lt;div class=&#34;admin-product-name&#34;&gt;${product.name}&lt;/div&gt;
                        &lt;div class=&#34;admin-product-details&#34;&gt;${product.price}/${product.unit} | ${category} | Stock: ${product.stock}&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;admin-product-actions&#34;&gt;
                        &lt;button class=&#34;admin-btn edit-btn&#34; onclick=&#34;editProduct(${product.id})&#34;&gt;Edit&lt;/button&gt;
                        &lt;button class=&#34;admin-btn delete-btn&#34; onclick=&#34;deleteProduct(${product.id})&#34;&gt;Delete&lt;/button&gt;
                    &lt;/div&gt;
                `;
                productList.appendChild(productItem);
            });
        }
        
        document.getElementById(&#39;totalProducts&#39;).textContent = totalProducts;
    } catch (error) {
        productList.innerHTML = &#39;&lt;div class=&#34;error&#34;&gt;Error loading products&lt;/div&gt;&#39;;
    }
}

function filterAdminProducts() {
    const searchTerm = document.getElementById(&#39;adminProductSearch&#39;).value.toLowerCase();
    const categoryFilter = document.getElementById(&#39;adminCategoryFilter&#39;).value;
    
    const productList = document.getElementById(&#39;adminProductList&#39;);
    productList.innerHTML = &#39;&#39;;
    
    let totalProducts = 0;
    
    for (const category in PRODUCTS) {
        if (categoryFilter !== &#39;all&#39; &amp;&amp; categoryFilter !== category) continue;
        
        PRODUCTS[category].forEach(product =&gt; {
            if (product.name.toLowerCase().includes(searchTerm)) {
                totalProducts++;
                const productItem = document.createElement(&#39;div&#39;);
                productItem.className = &#39;admin-product-item&#39;;
                productItem.innerHTML = `
                    &lt;div class=&#34;admin-product-info&#34;&gt;
                        &lt;div class=&#34;admin-product-name&#34;&gt;${product.name}&lt;/div&gt;
                        &lt;div class=&#34;admin-product-details&#34;&gt;${product.price}/${product.unit} | ${category} | Stock: ${product.stock}&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;admin-product-actions&#34;&gt;
                        &lt;button class=&#34;admin-btn edit-btn&#34; onclick=&#34;editProduct(${product.id})&#34;&gt;Edit&lt;/button&gt;
                        &lt;button class=&#34;admin-btn delete-btn&#34; onclick=&#34;deleteProduct(${product.id})&#34;&gt;Delete&lt;/button&gt;
                    &lt;/div&gt;
                `;
                productList.appendChild(productItem);
            }
        });
    }
    
    document.getElementById(&#39;totalProducts&#39;).textContent = totalProducts;
}

async function loadAdminSettings() {
    try {
        await loadBusinessInfo();
        document.getElementById(&#39;packagingCharge&#39;).value = BUSINESS_INFO.packagingCharge || 10;
    } catch (error) {
        console.error(&#39;Error loading settings:&#39;, error);
    }
}

async function saveSettings() {
    if (!adminToken) {
        showNotification(&#39;Please login first&#39;, &#39;error&#39;);
        return;
    }
    
    try {
        const packagingCharge = parseInt(document.getElementById(&#39;packagingCharge&#39;).value);
        
        await businessInfoAPI.update({
            ...BUSINESS_INFO,
            packagingCharge: packagingCharge
        }, adminToken);
        
        BUSINESS_INFO.packagingCharge = packagingCharge;
        
        showNotification(&#39;Settings saved successfully&#39;);
    } catch (error) {
        showNotification(&#39;Error saving settings&#39;, &#39;error&#39;);
    }
}

function showAddProductForm() {
    document.getElementById(&#39;addProductForm&#39;).classList.remove(&#39;hidden&#39;);
}

function hideAddProductForm() {
    document.getElementById(&#39;addProductForm&#39;).classList.add(&#39;hidden&#39;);
    document.getElementById(&#39;newProductName&#39;).value = &#39;&#39;;
    document.getElementById(&#39;newProductPrice&#39;).value = &#39;&#39;;
    document.getElementById(&#39;newProductImage&#39;).value = &#39;&#39;;
    document.getElementById(&#39;newProductStock&#39;).value = &#39;10&#39;;
    document.getElementById(&#39;newProductImagePreview&#39;).innerHTML = &#39;&#39;;
}

async function addNewProduct() {
    if (!adminToken) {
        showNotification(&#39;Please login first&#39;, &#39;error&#39;);
        return;
    }
    
    const name = (document.getElementById(&#39;newProductName&#39;).value || &#39;&#39;).trim();
    const priceValue = document.getElementById(&#39;newProductPrice&#39;).value;
    const price = parseFloat(priceValue);
    const category = document.getElementById(&#39;newProductCategory&#39;).value;
    const unit = document.getElementById(&#39;newProductUnit&#39;).value;
    const stockValue = document.getElementById(&#39;newProductStock&#39;).value;
    const stock = stockValue ? parseInt(stockValue) : 0;
    const image = (document.getElementById(&#39;newProductImage&#39;).value || &#39;&#39;).trim();
    
    if (!name || name.length === 0) {
        showNotification(&#39;Please enter product name&#39;, &#39;error&#39;);
        return;
    }
    
    if (!priceValue || isNaN(price) || price &lt;= 0) {
        showNotification(&#39;Please enter a valid price&#39;, &#39;error&#39;);
        return;
    }
    
    if (!image || image.length === 0) {
        showNotification(&#39;Please enter product image URL&#39;, &#39;error&#39;);
        return;
    }
    
    if (!category) {
        showNotification(&#39;Please select a category&#39;, &#39;error&#39;);
        return;
    }
    
    if (!unit) {
        showNotification(&#39;Please select a unit&#39;, &#39;error&#39;);
        return;
    }
    
    try {
        const allProducts = Object.values(PRODUCTS).flat();
        const newId = allProducts.length &gt; 0 ? Math.max(...allProducts.map(p =&gt; p.id)) + 1 : 1;
        
        const productData = {
            id: newId,
            name: String(name).trim(),
            price: Number(price),
            image: String(image).trim(),
            unit: String(unit),
            stock: Number(stock) || 0,
            category: String(category)
        };
        
        await productsAPI.create(productData, adminToken);
        
        await loadAllProducts();
        hideAddProductForm();
        showNotification(&#39;Product added successfully&#39;);
    } catch (error) {
        showNotification(&#39;Error adding product&#39;, &#39;error&#39;);
    }
}

function editProduct(productId) {
    let product = null;
    let productCategory = null;
    
    for (const category in PRODUCTS) {
        product = PRODUCTS[category].find(p =&gt; p.id === productId);
        if (product) {
            productCategory = category;
            break;
        }
    }
    
    if (!product) return;
    
    document.getElementById(&#39;editProductName&#39;).value = product.name;
    document.getElementById(&#39;editProductPrice&#39;).value = product.price;
    document.getElementById(&#39;editProductCategory&#39;).value = productCategory;
    document.getElementById(&#39;editProductUnit&#39;).value = product.unit;
    document.getElementById(&#39;editProductStock&#39;).value = product.stock;
    document.getElementById(&#39;editProductImage&#39;).value = product.image;
    
    // Set image preview
    const editImagePreview = document.getElementById(&#39;editProductImagePreview&#39;);
    if (editImagePreview) {
        editImagePreview.innerHTML = `&lt;img src=&#34;${product.image}&#34; style=&#34;max-width: 100%; max-height: 100%; border-radius: 5px;&#34;&gt;`;
    }
    
    editingProductId = productId;
    
    document.getElementById(&#39;editProductForm&#39;).classList.remove(&#39;hidden&#39;);
}

function hideEditProductForm() {
    document.getElementById(&#39;editProductForm&#39;).classList.add(&#39;hidden&#39;);
    editingProductId = null;
}

async function updateProduct() {
    if (!editingProductId || !adminToken) {
        showNotification(&#39;Please login first&#39;, &#39;error&#39;);
        return;
    }
    
    const nameInput = document.getElementById(&#39;editProductName&#39;);
    const priceInput = document.getElementById(&#39;editProductPrice&#39;);
    const categoryInput = document.getElementById(&#39;editProductCategory&#39;);
    const unitInput = document.getElementById(&#39;editProductUnit&#39;);
    const stockInput = document.getElementById(&#39;editProductStock&#39;);
    const imageInput = document.getElementById(&#39;editProductImage&#39;);
    
    if (!nameInput || !priceInput || !categoryInput || !unitInput || !stockInput || !imageInput) {
        showNotification(&#39;Error: Form fields not found&#39;, &#39;error&#39;);
        return;
    }
    
    const name = (nameInput.value || &#39;&#39;).trim();
    const priceValue = priceInput.value;
    const price = parseFloat(priceValue);
    const category = categoryInput.value;
    const unit = unitInput.value;
    const stockValue = stockInput.value;
    const stock = stockValue ? parseInt(stockValue) : 0;
    const image = (imageInput.value || &#39;&#39;).trim();
    
    if (!name || name.length === 0) {
        showNotification(&#39;Please enter product name&#39;, &#39;error&#39;);
        nameInput.focus();
        return;
    }
    
    if (!priceValue || isNaN(price) || price &lt;= 0) {
        showNotification(&#39;Please enter a valid price&#39;, &#39;error&#39;);
        priceInput.focus();
        return;
    }
    
    if (!image || image.length === 0) {
        showNotification(&#39;Please enter product image URL&#39;, &#39;error&#39;);
        imageInput.focus();
        return;
    }
    
    if (!category) {
        showNotification(&#39;Please select a category&#39;, &#39;error&#39;);
        categoryInput.focus();
        return;
    }
    
    if (!unit) {
        showNotification(&#39;Please select a unit&#39;, &#39;error&#39;);
        unitInput.focus();
        return;
    }
    
    if (isNaN(stock) || stock &lt; 0) {
        showNotification(&#39;Please enter a valid stock quantity&#39;, &#39;error&#39;);
        stockInput.focus();
        return;
    }
    
    const updateData = {
        name: String(name).trim(),
        price: Number(price),
        image: String(image).trim(),
        unit: String(unit),
        stock: Number(stock) || 0,
        category: String(category)
    };
    
    if (!updateData.name || updateData.name.length === 0) {
        showNotification(&#39;Product name cannot be empty&#39;, &#39;error&#39;);
        nameInput.focus();
        return;
    }
    
    try {
        await productsAPI.update(editingProductId, updateData, adminToken);
        
        await loadAllProducts();
        await loadAdminProducts();
        
        const stockTab = document.getElementById(&#39;stockTab&#39;);
        if (stockTab &amp;&amp; stockTab.classList.contains(&#39;active&#39;)) {
            await loadStockManagement();
        }
        
        loadCategoryProducts(currentCategory);
        
        hideEditProductForm();
        showNotification(&#39;Product updated successfully&#39;);
    } catch (error) {
        console.error(&#39; Update product error:&#39;, error);
        showNotification(&#39;Error updating product&#39;, &#39;error&#39;);
    }
}

async function deleteProduct(productId) {
    if (!adminToken) {
        showNotification(&#39;Please login first&#39;, &#39;error&#39;);
        return;
    }
    
    if (confirm(&#39;Are you sure you want to delete this product?&#39;)) {
        try {
            await productsAPI.delete(productId, adminToken);
            await loadAdminProducts();
            showNotification(&#39;Product deleted successfully&#39;);
        } catch (error) {
            showNotification(&#39;Error deleting product&#39;, &#39;error&#39;);
        }
    }
}

// Stock management functions
async function loadStockManagement() {
    const stockList = document.getElementById(&#39;stockList&#39;);
    if (!stockList) return;
    
    stockList.innerHTML = &#39;&lt;div class=&#34;loading&#34;&gt;Loading stock management...&lt;/div&gt;&#39;;
    
    if (!PRODUCTS || Object.keys(PRODUCTS).length === 0) {
        await loadAllProducts();
    }
    
    stockList.innerHTML = &#39;&#39;;
    
    let outOfStockCount = 0;
    let lowStockCount = 0;
    
    for (const category in PRODUCTS) {
        if (!PRODUCTS[category] || !Array.isArray(PRODUCTS[category])) continue;
        
        PRODUCTS[category].forEach(product =&gt; {
            const stockValue = product.stock ?? 0;
            const isOutOfStock = stockValue &lt;= 0;
            const isLowStock = stockValue &gt; 0 &amp;&amp; stockValue &lt; 10;
            
            if (isOutOfStock) outOfStockCount++;
            if (isLowStock) lowStockCount++;
            
            const stockItem = document.createElement(&#39;div&#39;);
            stockItem.className = &#39;stock-item&#39;;
            const stockInputId = `stock-input-${product.id}`;
            stockItem.innerHTML = `
                &lt;div class=&#34;stock-info&#34;&gt;
                    &lt;div class=&#34;stock-name&#34;&gt;${product.name}&lt;/div&gt;
                    &lt;div class=&#34;stock-details&#34;&gt;${product.price}/${product.unit} | ${category}&lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&#34;stock-actions&#34;&gt;
                    &lt;span class=&#34;stock-status ${isOutOfStock ? &#39;out-of-stock&#39; : &#39;in-stock&#39;}&#34; style=&#34;min-width: 140px; text-align: center;&#34;&gt;
                        ${isOutOfStock ? &#39;Currently Not Available&#39; : (isLowStock ? &#39;Low Stock&#39; : &#39;In Stock&#39;)}
                    &lt;/span&gt;
                    &lt;input type=&#34;number&#34; class=&#34;stock-input&#34; id=&#34;${stockInputId}&#34; data-product=&#34;${product.id}&#34; value=&#34;${stockValue}&#34; min=&#34;0&#34;&gt;
                    &lt;button class=&#34;admin-btn save-btn&#34; onclick=&#34;updateStockFromInput(${product.id}, &#39;${stockInputId}&#39;)&#34;&gt;Update&lt;/button&gt;
                &lt;/div&gt;
            `;
            stockList.appendChild(stockItem);
        });
    }
    
    const totalProductsEl = document.getElementById(&#39;totalProducts&#39;);
    const totalOrdersEl = document.getElementById(&#39;totalOrders&#39;);
    if (totalProductsEl) {
        totalProductsEl.textContent = Object.values(PRODUCTS).flat().length;
    }
    if (totalOrdersEl) {
        totalOrdersEl.textContent = outOfStockCount + lowStockCount;
    }
}

function updateStockFromInput(productId, inputId) {
    const inputElement = document.getElementById(inputId);
    if (!inputElement) {
        showNotification(&#39;Error: Could not find stock input&#39;, &#39;error&#39;);
        return;
    }
    const stockValue = inputElement.value;
    updateStock(productId, stockValue);
}

function filterStockProducts() {
    const searchTerm = document.getElementById(&#39;stockSearch&#39;).value.toLowerCase();
    const categoryFilter = document.getElementById(&#39;stockCategoryFilter&#39;).value;
    
    const stockList = document.getElementById(&#39;stockList&#39;);
    if (!stockList) return;
    
    stockList.innerHTML = &#39;&#39;;
    
    for (const category in PRODUCTS) {
        if (!PRODUCTS[category] || !Array.isArray(PRODUCTS[category])) continue;
        if (categoryFilter !== &#39;all&#39; &amp;&amp; categoryFilter !== category) continue;
        
        PRODUCTS[category].forEach(product =&gt; {
            if (product.name.toLowerCase().includes(searchTerm)) {
                const stockValue = product.stock ?? 0;
                const isOutOfStock = stockValue &lt;= 0;
                const isLowStock = stockValue &gt; 0 &amp;&amp; stockValue &lt; 10;
                
                const stockItem = document.createElement(&#39;div&#39;);
                stockItem.className = &#39;stock-item&#39;;
                const stockInputId = `stock-input-${product.id}`;
                stockItem.innerHTML = `
                    &lt;div class=&#34;stock-info&#34;&gt;
                        &lt;div class=&#34;stock-name&#34;&gt;${product.name}&lt;/div&gt;
                        &lt;div class=&#34;stock-details&#34;&gt;${product.price}/${product.unit} | ${category}&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;stock-actions&#34;&gt;
                        &lt;span class=&#34;stock-status ${isOutOfStock ? &#39;out-of-stock&#39; : &#39;in-stock&#39;}&#34; style=&#34;min-width: 140px; text-align: center;&#34;&gt;
                            ${isOutOfStock ? &#39;Currently Not Available&#39; : (isLowStock ? &#39;Low Stock&#39; : &#39;In Stock&#39;)}
                        &lt;/span&gt;
                        &lt;input type=&#34;number&#34; class=&#34;stock-input&#34; id=&#34;${stockInputId}&#34; data-product=&#34;${product.id}&#34; value=&#34;${stockValue}&#34; min=&#34;0&#34;&gt;
                        &lt;button class=&#34;admin-btn save-btn&#34; onclick=&#34;updateStockFromInput(${product.id}, &#39;${stockInputId}&#39;)&#34;&gt;Update&lt;/button&gt;
                    &lt;/div&gt;
                `;
                stockList.appendChild(stockItem);
            }
        });
    }
}

async function updateStock(productId, newStock) {
    if (!adminToken) {
        showNotification(&#39;Please login first&#39;, &#39;error&#39;);
        return;
    }
    
    if (newStock === null || newStock === undefined || newStock === &#39;&#39;) {
        newStock = 0;
    }
    
    const stockValue = parseInt(newStock);
    
    if (isNaN(stockValue) || stockValue &lt; 0) {
        showNotification(&#39;Please enter a valid stock quantity&#39;, &#39;error&#39;);
        return;
    }
    
    try {
        await productsAPI.updateStock(productId, stockValue, adminToken);
        
        await loadAllProducts();
        await loadStockManagement();
        loadCategoryProducts(currentCategory);
        
        showNotification(&#39;Stock updated successfully&#39;);
    } catch (error) {
        console.error(&#39; Error updating stock:&#39;, error);
        showNotification(&#39;Error updating stock&#39;, &#39;error&#39;);
    }
}
    </script>
  </body>
</html>
